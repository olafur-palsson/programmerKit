let iconActivePath="images/icon_19.png",iconRestPath="images/icon_19_deactivate.png";chrome.storage.sync.get(['activated'],function(items){if(items.activated===undefined){setIcon(!0)}});let portsByScriptId={};chrome.runtime.onConnect.addListener(function(port){portsByScriptId[port.sender.id+port.name]=port});function sendMessage(message){for(let contentScriptId in portsByScriptId){var port=portsByScriptId[contentScriptId];try{port.postMessage(message)}catch(e){delete portsByScriptId[contentScriptId]}}}
function updateIcon(){chrome.storage.sync.get(['activated'],function(items){if(items.activated!=!1){chrome.storage.sync.set({'activated':!1});chrome.browserAction.setIcon({path:iconRestPath})}else{chrome.storage.sync.set({'activated':!0});chrome.browserAction.setIcon({path:iconActivePath})}
    sendMessage(items.activated)})}
function setIcon(material_design){if(!material_design){chrome.storage.sync.set({'activated':!1});chrome.browserAction.setIcon({path:iconRestPath})}else{chrome.storage.sync.set({'activated':!0});chrome.browserAction.setIcon({path:iconActivePath})}
    chrome.storage.sync.get(['activated'],function(items){sendMessage(items.activated)})}
chrome.runtime.onMessage.addListener(function(request,sender,sendResponse){let activated;chrome.storage.sync.get(['activated'],function(items){activated=items.activated;if(request.method=="isActivated")
    sendResponse({status:activated});else sendResponse({})})});if(localStorage.activated!=!1){chrome.browserAction.setIcon({path:iconActivePath})}else{chrome.browserAction.setIcon({path:iconRestPath})}
chrome.browserAction.onClicked.addListener(updateIcon)