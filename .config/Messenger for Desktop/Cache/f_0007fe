if (self.CavalryLogger) { CavalryLogger.start_js(["VSG+w"]); }

__d("FBRTCRingType",[],(function(a,b,c,d,e,f){e.exports={GROUP_AUDIO_CALL:0,PEER_VIDEO_CALL:1,PEER_AUDIO_CALL:2,GROUP_VIDEO_CALL:3,LIVE_STREAM:4,PEER_ESCALATED_VIDEO_CALL:5,PEER_ESCALATED_AUDIO_CALL:6}}),null);
__d("BonfireLoggingPage",[],(function(a,b,c,d,e,f){e.exports=Object.freeze({BONFIRE_PAGE_LOGIN:"bonfire_page_login",BONFIRE_PAGE_BONFIRE:"bonfire_page_bonfire",BONFIRE_PAGE_GDPR_CONSENT:"bonfire_page_gdpr_consent",BONFIRE_PAGE_INVITE:"bonfire_page_invite"})}),null);
__d("BonfireLocalStorage",["BonfireLoggingPage","WebStorage","immutable","uuid"],(function(a,b,c,d,e,f){"use strict";__p&&__p();var g=1e3*60*5,h="bonfire_session_id",i="bonfire_session_activity_time",j="bonfire_device_id",k="bonfire_page",l=b("immutable").Set(Object.values(b("BonfireLoggingPage")));function a(){this.$1=this.$4()||this.$5(),this.$2=this.$6(),this.$3=this.$7()}a.prototype.$5=function(){var a={sessionID:b("uuid")(),lastSessionActivityTime:Date.now()},c=b("WebStorage").getSessionStorage();c&&(c.setItem(h,a.sessionID),c.setItem(i,String(a.lastSessionActivityTime)));return a};a.prototype.$6=function(){var a=b("WebStorage").getLocalStorage(),c=a&&a.getItem(j);if(typeof c==="string")return c;else{c=b("uuid")();a&&a.setItem(j,c);return c}};a.prototype.$4=function(){var a=b("WebStorage").getSessionStorageForRead(),c=a&&a.getItem(h);a=a&&Number(a.getItem(i));return typeof c==="string"&&a?{sessionID:c,lastSessionActivityTime:a}:null};a.prototype.$8=function(){var a=Date.now(),c=b("WebStorage").getSessionStorage(),d=a-g;if(this.$1.lastSessionActivityTime<d)return this.$5().sessionID;else{this.$1.lastSessionActivityTime=a;c&&c.setItem(i,String(a));return this.$1.sessionID}};a.prototype.getSessionID=function(){return this.$8()};a.prototype.getDeviceID=function(){return this.$2};a.prototype.$7=function(){var a=b("WebStorage").getSessionStorageForRead();a=a&&a.getItem(k);return l.contains(a)?a:null};a.prototype.getPage=function(){return this.$3};a.prototype.setPage=function(a){this.$3=a;var c=b("WebStorage").getSessionStorage();c&&(a?c.setItem(k,a):c.removeItem(k))};e.exports=new a()}),null);
__d("BonfireUserActionsTypedLogger",["Banzai","GeneratedLoggerUtils","nullthrows"],(function(a,b,c,d,e,f){"use strict";__p&&__p();function a(){this.clear()}a.prototype.log=function(){b("GeneratedLoggerUtils").log("logger:BonfireUserActionsLoggerConfig",this.$1,b("Banzai").BASIC)};a.prototype.logVital=function(){b("GeneratedLoggerUtils").log("logger:BonfireUserActionsLoggerConfig",this.$1,b("Banzai").VITAL)};a.prototype.logImmediately=function(){b("GeneratedLoggerUtils").log("logger:BonfireUserActionsLoggerConfig",this.$1,{signal:!0})};a.prototype.clear=function(){this.$1={};return this};a.prototype.getData=function(){return babelHelpers["extends"]({},this.$1)};a.prototype.updateData=function(a){this.$1=babelHelpers["extends"]({},this.$1,a);return this};a.prototype.setBonfireID=function(a){this.$1.bonfire_id=a;return this};a.prototype.setClientTime=function(a){this.$1.client_time=a;return this};a.prototype.setComponent=function(a){this.$1.component=a;return this};a.prototype.setControllerClass=function(a){this.$1.controller_class=a;return this};a.prototype.setControllerParameters=function(a){this.$1.controller_parameters=a;return this};a.prototype.setDeviceID=function(a){this.$1.device_id=a;return this};a.prototype.setDuration=function(a){this.$1.duration=a;return this};a.prototype.setErrorDomain=function(a){this.$1.error_domain=a;return this};a.prototype.setErrorType=function(a){this.$1.error_type=a;return this};a.prototype.setEvent=function(a){this.$1.event=a;return this};a.prototype.setExpectedParticipantCount=function(a){this.$1.expected_participant_count=a;return this};a.prototype.setPage=function(a){this.$1.page=a;return this};a.prototype.setParticipantCount=function(a){this.$1.participant_count=a;return this};a.prototype.setReferralSurface=function(a){this.$1.referral_surface=a;return this};a.prototype.setRequestID=function(a){this.$1.request_id=a;return this};a.prototype.setSessionID=function(a){this.$1.session_id=a;return this};a.prototype.setSurface=function(a){this.$1.surface=a;return this};a.prototype.setTime=function(a){this.$1.time=a;return this};a.prototype.setVC=function(a){this.$1.vc=a;return this};a.prototype.setWeight=function(a){this.$1.weight=a;return this};a.prototype.updateExtraData=function(a){a=b("nullthrows")(b("GeneratedLoggerUtils").serializeMap(a));b("GeneratedLoggerUtils").checkExtraDataFieldNames(a,g);this.$1=babelHelpers["extends"]({},this.$1,a);return this};a.prototype.addToExtraData=function(a,b){var c={};c[a]=b;return this.updateExtraData(c)};var g={bonfire_id:!0,client_time:!0,component:!0,controller_class:!0,controller_parameters:!0,device_id:!0,duration:!0,error_domain:!0,error_type:!0,event:!0,expected_participant_count:!0,page:!0,participant_count:!0,referral_surface:!0,request_id:!0,session_id:!0,surface:!0,time:!0,vc:!0,weight:!0};e.exports=a}),null);
__d("BonfireLogger",["BonfireFeatureGating","BonfireLocalStorage","BonfireUserActionsTypedLogger","Run","immutable"],(function(a,b,c,d,e,f){"use strict";__p&&__p();var g=b("immutable").Map;function a(){this.$1=g(),b("Run").onBeforeUnload(function(){this.logPageChange(null)}.bind(this))}a.prototype.logPageChange=function(a,c){c===void 0&&(c=null);var d=b("BonfireLocalStorage").getPage();a!==d?(d&&this.logStopTimer("bonfire_timer_page",{eventName:"page_exit"}),b("BonfireLocalStorage").setPage(a),a&&this.logStartTimer("bonfire_timer_page",{eventName:"page_enter",referralSurface:c})):this.$2("bonfire_timer_page")||this.$3("bonfire_timer_page")};a.prototype.logImpression=function(a,b){b===void 0&&(b=null),this.logEvent({eventName:"impression",surface:a,requestID:b})};a.prototype.logClick=function(a,b){this.logEvent({eventName:"tap",surface:a,component:b})};a.prototype.logEdit=function(a,b){this.logEvent({eventName:"edit",surface:a,component:b})};a.prototype.logError=function(a,b,c){this.logEvent({eventName:"error",surface:a,errorDomain:b,errorType:c})};a.prototype.logStartTimer=function(a,event){this.logEvent(event),this.$3(a)};a.prototype.logStopTimer=function(a,event){event.duration=this.$4(a),this.logEvent(event)};a.prototype.logEvent=function(event){var a={bonfire_id:event.bonfireID,client_time:Date.now(),error_domain:event.errorDomain,error_type:event.errorType,expected_participant_count:event.expectedParticipantCount,component:event.component,device_id:b("BonfireLocalStorage").getDeviceID(),duration:event.duration,event:event.eventName,page:b("BonfireLocalStorage").getPage(),participant_count:event.participantCount,referral_surface:event.referralSurface,session_id:b("BonfireLocalStorage").getSessionID(),surface:event.surface,request_id:event.requestID};b("BonfireFeatureGating").logImmediately()&&(a.page==="bonfire_page_login"||a.page==="bonfire_page_invite")?new(b("BonfireUserActionsTypedLogger"))().updateData(a).logImmediately():new(b("BonfireUserActionsTypedLogger"))().updateData(a).log()};a.prototype.$3=function(a){this.$1=this.$1.set(a,Date.now())};a.prototype.$4=function(a){var b=this.$1.get(a);if(b){this.$1=this.$1.remove(a);return Date.now()-b}return null};a.prototype.$2=function(a){return this.$1.has(a)};e.exports=new a()}),null);
__d("BonfireRingResponseMutation.graphql",[],(function(a,b,c,d,e,f){"use strict";a=function(){var a=[{kind:"LocalArgument",name:"input",type:"BonfireRingResponseData!",defaultValue:null}],b=[{kind:"LinkedField",alias:null,name:"bonfire_ring_response",storageKey:null,args:[{kind:"Variable",name:"data",variableName:"input",type:"BonfireRingResponseData!"}],concreteType:"BonfireRingResponseResponsePayload",plural:!1,selections:[{kind:"ScalarField",alias:null,name:"success",args:null,storageKey:null}]}];return{kind:"Request",operationKind:"mutation",name:"BonfireRingResponseMutation",id:"2392344367457929",text:null,metadata:{},fragment:{kind:"Fragment",name:"BonfireRingResponseMutation",type:"Mutation",metadata:null,argumentDefinitions:a,selections:b},operation:{kind:"Operation",name:"BonfireRingResponseMutation",argumentDefinitions:a,selections:b}}}();e.exports=a}),null);
__d("BonfireRingResponseMutation",["RelayFBEnvironment","RelayModern","RelayRuntime","BonfireRingResponseMutation.graphql"],(function(a,b,c,d,e,f){"use strict";var g=b("RelayModern").commitMutation;b("RelayRuntime").graphql;var h=function(){return b("BonfireRingResponseMutation.graphql")};function a(a){g(b("RelayFBEnvironment"),{mutation:h,variables:{input:{ring_response_type:a.ringResponseType,sender_fbid:a.senderFBID,sender_bonfire_user_id:a.senderBonfireUserID,sender_bonfire_id:a.senderBonfireID,ring_request_id:a.ringRequestID}}})}e.exports=a}),null);
__d("intlSummarizeNumber",["FbtNumberType","IntlCompactDecimalNumberFormatConfig","IntlVariations","intlNumUtils"],(function(a,b,c,d,e,f){__p&&__p();var g=3,h=14,i={ROUND:"ROUND",TRUNCATE:"TRUNCATE"},j={SHORT:"SHORT",LONG:"LONG"};function a(a,c,d,e){__p&&__p();d===void 0&&(d=j.SHORT);e===void 0&&(e=i.ROUND);d=b("IntlCompactDecimalNumberFormatConfig")[d==j.SHORT?"short_patterns":"long_patterns"];var f=a===0?0:Math.floor(Math.log10(Math.abs(a)));f>h&&(f=h);var l=k(a,f,c,e,d),m=l[0],n=l[1];l=l[2];if(l){f+=1;l=k(a,f,c,e,d);m=l[0];n=l[1];l[2]}e=b("FbtNumberType").getVariation(m)||b("IntlVariations").NUMBER_OTHER;l=f.toString();l=(d=d)!=null?(d=d[l])!=null?d[e.toString()]:d:d;if(!l||f<g||l.positive_prefix_pattern===""&&l.positive_suffix_pattern===""){e=c===undefined?0:c;return b("intlNumUtils").formatNumberWithThousandDelimiters(a,e)}return l&&l.min_integer_digits===0&&m===1?l.positive_prefix_pattern+l.positive_suffix_pattern:(l&&l.positive_prefix_pattern||"")+b("intlNumUtils").formatNumberWithThousandDelimiters(m,n)+(l&&l.positive_suffix_pattern||"")}function k(a,c,d,e,f){__p&&__p();var g=c.toString();g=(f=f)!=null?(f=f[g])!=null?f[b("IntlVariations").NUMBER_OTHER.toString()]:f:f;f=g&&g.min_integer_digits||c+1;var j=c-f+1;j=Math.abs(a)/Math.pow(10,j);var k=d!=null;d=k?d:g&&g.min_fraction_digits;d==null&&(d=c>2?1:0);g=e==i.TRUNCATE?b("intlNumUtils").truncateLongNumber(j.toString(),d):j.toFixed(d);e=parseFloat(g)*(a<0?-1:1);return[e,e%1===0&&!k?0:d,g.length>f+(d>0?d+1:0)+(j>=0?0:1)&&c<h]}e.exports=a}),null);
__d("Facepile.react",["cx","fbt","ix","HovercardLink","Image.react","Link.react","List.react","React","intlSummarizeNumber","joinClasses"],(function(a,b,c,d,e,f,g,h,i){__p&&__p();a=b("React").PropTypes;var j={small:24,medium:32,large:50};c=b("React").createClass({displayName:"Facepile",defaultProps:{moreColor:"blue",moreCount:0,showHovercard:!1,tooltipPosition:"above",showToolTip:!0,spacing:"none"},propTypes:{className:a.string,moreColor:a.oneOf(["blue","gray"]),moreCount:a.number,moreDialogLink:a.string,morePageLink:a.string,numFaces:a.number,onFaceClick:a.func,onComponentDidMount:a.func,profiles:a.arrayOf(a.shape({URL:a.any,name:a.node.isRequired,uniqueID:a.any.isRequired,profilePicURI:a.any.isRequired})).isRequired,showHovercard:a.bool,size:a.oneOf([28,"small","medium","large"]).isRequired,spacing:a.oneOf(["none","small","medium","large"]),showToolTip:a.bool,tooltipPosition:a.oneOf(["above","below","left","right"])},_onFaceClick:function(a,b){this.props.onFaceClick&&this.props.onFaceClick(a,b)},componentDidMount:function(){this.props.onComponentDidMount&&this.props.onComponentDidMount()},getPicSize:function(){return j[this.props.size]||this.props.size},renderFace:function(a,c){var d=this.getPicSize(),e=b("HovercardLink").constructEndpoint({id:a.uniqueID}).toString();return b("React").createElement("li",{className:"_43q7",key:a.uniqueID,onClick:this._onFaceClick.bind(this,a,c)},b("React").createElement(b("Link.react"),{"aria-label":a.name,className:"_2rt_ link","data-hover":this.props.showHovercard?null:"tooltip","data-hovercard":this.props.showHovercard?e:null,"data-ignoreclass":"_2rt_","data-tooltip-alignh":"left","data-tooltip-content":a.name,"data-tooltip-position":this.props.tooltipPosition,href:a.URL},b("React").createElement(b("Image.react"),{src:a.profilePicURI,width:d,height:d,className:"img"})))},renderMore:function(){if(!this.props.moreCount)return null;var a=this.props.numFaces!=null&&this.props.numFaces<=this.props.profiles.length?this.props.moreCount+1:this.props.moreCount,c=b("intlSummarizeNumber")(a,0),d=c.length,e;a===0||this.props.size==="small"&&d>2||this.props.size===28&&d>2||this.props.size==="medium"&&d>3||this.props.size==="large"&&d>6?e=b("React").createElement(b("Image.react"),{src:i("97502")}):e="+"+c;var f;(this.props.showToolTip===undefined||this.props.showToolTip===!0)&&(a===1?f=h._("1 other person"):f=h._("{num} other people",[h._param("num",a)]));c=b("joinClasses")("_43q8 _43q7"+(d<2?" _43qa":"")+(d===2?" _43qb":"")+(d===3?" _43qd":"")+(d>3?" _43qe":"")+(this.props.moreColor==="blue"?" _49c8":"")+(this.props.moreColor==="gray"?" _49cb":""));return b("React").createElement("li",{className:c},b("React").createElement("a",{"data-hover":f?"tooltip":null,"data-tooltip-position":f?"right":null,"data-tooltip-content":f,ajaxify:this.props.moreDialogLink||this.props.morePageLink,href:this.props.morePageLink,role:"button",rel:this.props.moreDialogLink?"dialog":null},e))},render:function(){var a=this.props.spacing||this.defaultProps.spacing;a=b("joinClasses")(this.props.className,"_43qm"+(this.props.size==28?" _3cxu":"")+(this.props.size=="small"?" _43q9":"")+(this.props.size=="medium"?" _43qc":"")+(this.props.size=="large"?" _43qf":"")+(a!=this.defaultProps.spacing?" _4nab":""));var c=this.props.numFaces==undefined?this.props.profiles:this.props.profiles.slice(0,this.props.moreCount?this.props.numFaces-1:this.props.numFaces);return b("React").createElement("div",{className:a,style:this.props.style},b("React").createElement(b("List.react"),{className:"_4cg3",direction:"horizontal",spacing:this.props.spacing||"none",border:"none"},c.map(this.renderFace),this.renderMore()))}});e.exports=c}),null);
__d("FBRTCIncomingCallController",["fbt","Cache","DocumentTitle","FBRTCCallBlockingStore","FBRTCCallSummary","FBRTCCallSummaryStore","FBRTCCallUIWrapper","FBRTCConstants","FBRTCLocalMessageQueue","FBRTCLocalUploadLogLevel","FBRTCLogger","FBRTCMessage","FBRTCMessageDedup","FBRTCMessageSender","FBRTCSupport","MercuryIDs","MessengerParticipants.bs","RTCSignalingExperiments","RTWebExperiments","UserActivity"],(function(a,b,c,d,e,f,g){__p&&__p();var h=30;function a(a,c,d){"use strict";this.$11=null,this.$1=a,this.$2=c,this.$3=d,this.$4=null,this.$5=null,this.$6=new(b("FBRTCMessageSender"))(),this.$7=b("FBRTCCallSummaryStore").getInstance(),this.$8=b("FBRTCLogger").getInstance(),this.$9=null,this.$10=new(b("Cache"))()}a.prototype.setCustomAnswerHandler=function(a){"use strict";this.$11=a};a.prototype.onMessageReceived=function(a){"use strict";__p&&__p();var c;try{c=new(b("FBRTCMessage"))(a)}catch(b){this.$8.logErrorWithoutID("Unknown data: "+JSON.stringify(a));return}if(!b("FBRTCMessageDedup").check(c.peerID,c.callID,c.msgID)){c.isOffer()&&this.$12()&&this.$6.sendOfferAck(c.peerID,c.callID,c.msg);this.$8.logInfo(c.peerID,c.callID,"Ignoring message (duplicate): "+c.msgID);return}this.$8.logReceivedMessage(c.peerID,c.callID,c.msg);!b("RTWebExperiments").enableCallCollisionFix()&&b("FBRTCSupport").isWebrtcSupported()&&c.msgType!==b("FBRTCConstants").PayloadType.OFFER&&b("FBRTCLocalMessageQueue").enqueueMessage(c.peerID,c.msgID,a);switch(c.msgType){case b("FBRTCConstants").PayloadType.OFFER:this.$13(c);break;case b("FBRTCConstants").PayloadType.HANGUP:this.$14(c);break;case b("FBRTCConstants").PayloadType.OTHER_DISMISS:this.$15(c);break;case b("FBRTCConstants").PayloadType.ICE_CANDIDATE:case b("FBRTCConstants").PayloadType.OFFER_ACK:case b("FBRTCConstants").PayloadType.ANSWER:case b("FBRTCConstants").PayloadType.MSG_ACK:case b("FBRTCConstants").PayloadType.OK:case b("FBRTCConstants").PayloadType.PING:case b("FBRTCConstants").PayloadType.PRANSWER:case b("FBRTCConstants").PayloadType.ICERESTART_OFFER:case b("FBRTCConstants").PayloadType.ICERESTART_ANSWER:case b("FBRTCConstants").PayloadType.PCRESTART_ANSWER:case b("FBRTCConstants").PayloadType.PCRESTART_OFFER:case b("FBRTCConstants").PayloadType.SDP_UPDATE:case b("FBRTCConstants").PayloadType.ANSWER_ACK:case b("FBRTCConstants").PayloadType.SET_VIDEO:case b("FBRTCConstants").PayloadType.OFFER_NACK:case b("FBRTCConstants").PayloadType.VIDEO_REQUEST:case b("FBRTCConstants").PayloadType.ACK:break;default:break}};a.prototype.$13=function(a){"use strict";__p&&__p();var c=a.callID,d=a.msg,e=a.peerID;if(this.$16(c))return;if(d.calltype){this.$6.sendOfferNack(e,c,d);return}this.$12()?this.$6.sendOfferAck(e,c,d):this.$6.sendOfferNack(e,c,d);this.$8.logCallAction(e,c,b("FBRTCLogger").CallAction.RECEIVED_CALL);var f=this.$17(e,c,a);f.setUploadLogLevel(b("FBRTCLocalUploadLogLevel").getUploadLogLevel(b("FBRTCConstants").convertToUploadLogLevel(d.ull)));if(b("FBRTCCallBlockingStore").getBlockingStatus()){this.$18(e,c,f,b("FBRTCConstants").CallEndReason.IGNORE_CALL,!1,!1,!1,"calling disabled");return}var g=this.$1.getCallEndReasonForNewRequest();if(this.$4&&!this.$4.isForPeer(e)||g===b("FBRTCConstants").CallEndReason.IN_ANOTHER_CALL){this.$18(e,c,f,b("FBRTCConstants").CallEndReason.IN_ANOTHER_CALL,!1,!1,!0);this.$3.onCallMissed(e);return}if(!b("FBRTCSupport").isWebrtcSupported()){this.$18(e,c,f,b("FBRTCConstants").CallEndReason.UNSUPPORTED_VERSION,!1,!1,!1);this.$2.showForIncomingCall(c,e);return}g=new this.$1(e,c);this.$5=f;g.addListener("answerCall",function(b,d){this.$19(e,c,a,f,d)}.bind(this));g.addListener("ignoreCall",function(){this.$20(e,c,f)}.bind(this));g.addListener("timeout",function(){this.$21(e,c,f)}.bind(this));this.$3.hideDialog();d=d.videoon?b("FBRTCConstants").IncomingCallDialogTypes.VIDEO:b("FBRTCConstants").IncomingCallDialogTypes.AUDIO;g.showIncomingDialog(d);this.$4=g;this.$8.logEvent(e,c,"Incoming call dialog shown");this.$22(e)};a.prototype.$22=function(a){"use strict";document.hasFocus()||this.$23(a)};a.prototype.$24=function(){"use strict";this.$25()};a.prototype.$23=function(a){"use strict";a=b("MercuryIDs").getParticipantIDFromUserID(a);b("MessengerParticipants.bs").get(a,function(a){if(!this.$4)return;this.$9=b("DocumentTitle").blink(g._("{name} is calling",[g._param("name",a.short_name)]))}.bind(this));b("UserActivity").subscribeOnce(this.$25.bind(this))};a.prototype.$25=function(){"use strict";this.$9&&(this.$9.stop(),this.$9=null)};a.prototype.$26=function(){"use strict";this.$4&&this.$4.cancel(),this.$4=null,this.$5=null,this.$24()};a.prototype.$14=function(a){"use strict";__p&&__p();var c=a.peerID,d=a.callID;a=a.msg;this.$27(d);if(this.$4&&this.$4.isForPeerAndCall(c,d)){a=a.reason;(typeof a==="string"||a instanceof String)&&(a=b("FBRTCConstants").endCallReasonFromString(a));this.$18(c,d,this.$5,a,!0,!0,!1);this.$26();a!==b("FBRTCConstants").CallEndReason.OTHER_INSTANCE_HANDLED&&(this.$3.onCallMissed(c),this.$3.showDialog())}};a.prototype.$12=function(){"use strict";return b("FBRTCSupport").isWebrtcSupported()};a.prototype.$15=function(a){"use strict";a=a.callID;this.$27(a);b("FBRTCSupport").isWebrtcSupported()||this.$2.dismiss();this.$4&&this.$4.isForCall(a)&&this.$26()};a.prototype.$27=function(a){"use strict";this.$10.set(a,!0,null,h)};a.prototype.$16=function(a){"use strict";return this.$10.has(a)};a.prototype.$17=function(a,c,d){"use strict";a=new(b("FBRTCCallSummary"))({peerID:a,callID:c,isCaller:!1});a.setCallTrigger("incoming_p2p_ring_dialog");a.setActiveConnection("p2p");a.onFullMessageReceived(d);a.onOfferAckSent(d.msg);return a};a.prototype.$19=function(a,c,d,e,f){"use strict";__p&&__p();var g=!d.msg.videoon;e.onPressedAnswer();e.save(this.$7);this.$8.logCallAction(a,c,b("FBRTCLogger").CallAction.ANSWER_CALL);this.$6.sendOtherDismiss(c);b("RTWebExperiments").passOfferWithWindowMessages()||b("FBRTCLocalMessageQueue").writePeerOfferToStorage(a,d.originalMessageData);d=this.$11;d?d({peerID:a,callID:String(c),callSummary:e,initializeVideo:f}):b("FBRTCCallUIWrapper").openAsCallee(a,c,e,g,f);this.$26()};a.prototype.$20=function(a,c,d){"use strict";this.$18(a,c,d,b("FBRTCConstants").CallEndReason.IGNORE_CALL,!1,!0,!0),this.$26()};a.prototype.$21=function(a,c,d){"use strict";this.$18(a,c,d,b("FBRTCConstants").CallEndReason.NO_ANSWER_TIMEOUT,!1,!1,!1),this.$26(),this.$3.onCallMissed(a),this.$3.showDialog()};a.prototype.$18=function(a,c,d,e,f,g,h,i){i===void 0&&(i=null);h&&this.$6.sendHangup(a,c,e);g&&this.$6.sendOtherDismiss(c);d&&(d.onCallEnded(e,f,null,i),d.save(this.$7));h=b("FBRTCConstants").fullCallEndReasonString(e,f);this.$8.logCallAction(a,c,b("FBRTCLogger").CallAction.END_CALL,h)};e.exports=a}),null);
__d("XBrowserNotSupportedDialogController",["XController"],(function(a,b,c,d,e,f){e.exports=b("XController").create("/videocall/browser_not_supported/",{is_group_call:{type:"Bool",defaultValue:!1},participants:{type:"StringVector"},user_id:{type:"Int"},warning:{type:"Bool",defaultValue:!1},call_type:{type:"Enum",defaultValue:2,enumType:0},__asyncDialog:{type:"Int"}})}),null);
__d("FBRTCUnsupportedBrowserMessage",["AsyncDialog","AsyncRequest","FBRTCCallConstants","FBRTCSoundController","XBrowserNotSupportedDialogController"],(function(a,b,c,d,e,f){__p&&__p();var g=b("FBRTCCallConstants").FBRTCCallType;a={_dialog:null,warnForOutgoingCall:function(a){var c=b("XBrowserNotSupportedDialogController").getURIBuilder().setBool("warning",!0).getURI();this._presentDialog(c,a)},showForOutgoingCall:function(){var a=b("XBrowserNotSupportedDialogController").getURIBuilder().getURI();this._presentDialog(a)},showForIncomingCall:function(a,c){b("FBRTCSoundController").playIncomingRingtone(a,c,{loop:!1,isP2P:!0,isUnsupportedDialog:!0});a=b("XBrowserNotSupportedDialogController").getURIBuilder().setInt("user_id",c).getURI();this._presentDialog(a)},showForIncomingGroupCall:function(a,c,d,e){b("FBRTCSoundController").playIncomingRingtone(a,e,{loop:!1,isP2P:!1,isUnsupportedDialog:!0});a=b("XBrowserNotSupportedDialogController").getURIBuilder().setBool("is_group_call",!0).setInt("user_id",d).setStringVector("participants",c).getURI();this._presentDialog(a)},showForOutgoingGroupCall:function(){var a=b("XBrowserNotSupportedDialogController").getURIBuilder().setBool("is_group_call",!0).getURI();this._presentDialog(a)},showForUnsupportedCollabCall:function(){var a=b("XBrowserNotSupportedDialogController").getURIBuilder().setEnum("call_type",g.COLLAB_VIDEO_CALL).getURI();this._presentDialog(a)},showForUnsupportedCollabScreenSharing:function(){var a=b("XBrowserNotSupportedDialogController").getURIBuilder().setEnum("call_type",g.COLLAB_SCREEN_SHARE_CALL).getURI();this._presentDialog(a)},dismiss:function(){this._dialog&&this._dialog.hide()},_presentDialog:function(a,c){if(this._dialog)return;a=new(b("AsyncRequest"))(a);b("AsyncDialog").send(a,function(a){this._dialog=a,a.subscribe("hide",function(){this._dialog=null,c&&c()}.bind(this))}.bind(this))}};e.exports=a}),null);
__d("PartiesRingResponseType",[],(function(a,b,c,d,e,f){e.exports=Object.freeze({IGNORED_CALL:"ignored_call",ACCEPTED_CALL:"accepted_call",NO_ANSWER_TIMEOUT:"no_answer_timeout",RING_ACK:"ring_ack",CANCEL_ACK:"cancel_ack",ACCEPTED_ON_ANOTHER_DEVICE_ACK:"accepted_on_another_device_ack",IGNORED_ON_ANOTHER_DEVICE_ACK:"ignored_on_another_device_ack",RECEIVER_CONNECTED:"receiver_connected"})}),null);
__d("PartiesRingStopReason",[],(function(a,b,c,d,e,f){e.exports=Object.freeze({ACCEPTED_ON_ANOTHER_DEVICE:"accepted_on_another_device",IGNORED_ON_ANOTHER_DEVICE:"ignored_on_another_device",CANCELLED_BY_CALLER:"cancelled_by_caller"})}),null);
__d("BonfireNotificationUtils",["BonfireRingResponseMutation","FBRTCDismissReason","FBRTCMessageType","FBRTCRingType","PartiesRingResponseType","PartiesRingStopReason","generateRTCTransactionID"],(function(a,b,c,d,e,f){__p&&__p();a={sendRingAck:function(a){l("ring_start",a)&&b("BonfireRingResponseMutation")({ringResponseType:b("PartiesRingResponseType").RING_ACK,senderFBID:h(a.data),senderBonfireUserID:i(a.data),senderBonfireID:j(a.data),ringRequestID:k(a.data)})},toFBRTCMessage:function(a){if(l("ring_start",a))return{endpoint:{appId:"",deviceId:"",userId:h(a.data)},jsonPayload:{body:{ringRequest:{caller:h(a.data),otherParticipants:[],capabilities_DEPRECATED:[],ringType:b("FBRTCRingType").GROUP_VIDEO_CALL}},header:{type:b("FBRTCMessageType").RING,conferenceName:g(a.data),transactionId:b("generateRTCTransactionID")(),retryCount:0,serverInfoData:""}}};else if(l("ring_stop",a))return{endpoint:{appId:"",deviceId:"",userId:h(a.data)},jsonPayload:{body:{dismissRequest:{reason:m(a.data),detailedReasonString:""}},header:{type:b("FBRTCMessageType").DISMISS,conferenceName:g(a.data),transactionId:b("generateRTCTransactionID")(),retryCount:0,serverInfoData:""}}};return null}};function g(a){return a.ppi?"BONFIRE:"+a.ppi:"BONFIRE:"}function h(a){return a.o.toString()}function i(a){return a.pui}function j(a){return a.ppi}function k(a){return a.ppnid}function l(a,b){return b.action===a}function m(a){switch(a.prsr){case b("PartiesRingStopReason").ACCEPTED_ON_ANOTHER_DEVICE:return b("FBRTCDismissReason").ANSWERED_ON_ANOTHER_DEVICE;case b("PartiesRingStopReason").IGNORED_ON_ANOTHER_DEVICE:return b("FBRTCDismissReason").REJECTED_ON_ANOTHER_DEVICE;case b("PartiesRingStopReason").CANCELLED_BY_CALLER:return b("FBRTCDismissReason").CALL_ENDED;default:return b("FBRTCDismissReason").INTERNAL_ERROR}}e.exports=a}),null);
__d("XBonfireAppController",["XController"],(function(a,b,c,d,e,f){e.exports=b("XController").create("/bonfire/{?*bonfire_id}",{bonfire_id:{type:"String"},referrer:{type:"String"}})}),null);
__d("XFacebookBonfireController",["XController"],(function(a,b,c,d,e,f){e.exports=b("XController").create("/fbbonfire/",{rest:{type:"String"}})}),null);
__d("PartiesUtils",["CurrentUser","URI","XBonfireAppController","XFacebookBonfireController"],(function(a,b,c,d,e,f){"use strict";__p&&__p();var g=new(b("URI"))(document.URL),h=b("XBonfireAppController").getURIBuilder().getURI().setDomain(g.getDomain().replace(/\.[^.]+\.com$/,".mybonfire.com")).setProtocol("https").toString();function i(a){return/^\d+$/.test(a)}a={payloadParticipantsToPartiesUsers:function(a){return a.map(function(a){return{accepts_messenger_user_feedback:!1,big_image_src:a.profile_picture_uri,employee:!1,fbid:a.fbid.toString(),gender:0,href:null,id:"fbid:"+a.fbid.toString(),image_src:a.profile_picture_uri,is_business_enabled:null,is_employee_away:null,is_friend:null,is_messenger_user:null,is_messenger_platform_bot:null,is_parties_user:!0,is_verified:null,name:a.display_name,short_name:a.display_name,user_type:null,vanity:a.username,timezone:null,personal_id:null,work_id:null}})},joinBonfire:function(a,c){if(i(a)){a=b("CurrentUser").isWorkUser()?b("XFacebookBonfireController").getURIBuilder().getURI()+a:b("XBonfireAppController").getURIBuilder().setString("bonfire_id",a).setString("referrer",c).getURI().setDomain(g.getDomain().replace(/\.[^.]+\.com$/,".mybonfire.com")).setProtocol("https");window.open(a,"_blank")}},navigateToBonfireAppPage:function(){window.open(h,"_blank")}};e.exports=a}),null);
__d("FBRTCGroupCallIncomingController",["invariant","BonfireFeatureGating","BonfireNotificationUtils","FBRTCCallBlockingStore","FBRTCCallSummary","FBRTCCallSummaryStore","FBRTCCallUIWrapper","FBRTCCapability","FBRTCConfig","FBRTCConstants","FBRTCDeviceStatus","FBRTCHangupReason","FBRTCLogger","FBRTCMultiwayMessage","FBRTCRingType","FBRTCRtcResponseStatusCode","FBRTCSupport","FBRTCTransactions","FBRTCUnsupportedBrowserMessage","MessengerRTCUnsupportedBrowserDialogController","PartiesUtils","RTCMWProtocolHandler","RTCUtils","RTWebClientFeatureGating","generateRTCCallID","nullthrows","promiseDone","randomInt"],(function(a,b,c,d,e,f,g){__p&&__p();var h,i=b("FBRTCConstants").CallEndReason;c=b("FBRTCTransactions").FBRTCTransactionOwner;function j(a){var c=b("RTCUtils").parseBonfireID(a.conferenceName);c?b("PartiesUtils").joinBonfire(c,b("FBRTCConfig").isMessengerDotCom()?"messenger_ring":"facebook_ring"):b("FBRTCCallUIWrapper").openGroupCallURI(a.conferenceName,a.callID,a.hasVideo,a.initializeVideo,a.multiwayCoreTier,a.multiwayWwwTier,a.serverInfoData,"answer button",a.callSummary)}d=babelHelpers.inherits(a,c);h=d&&d.prototype;function a(a,b){"use strict";h.constructor.call(this),this.$FBRTCGroupCallIncomingController5=j,this.$FBRTCGroupCallIncomingController2=b,this.$FBRTCGroupCallIncomingController3=a,this.$FBRTCGroupCallIncomingController4=null}a.prototype.$FBRTCGroupCallIncomingController6=function(a){"use strict";this.$FBRTCGroupCallIncomingController1=new(b("FBRTCCallSummary"))({peerID:"MW_PEER_ID",callID:a,isCaller:!1}),this.$FBRTCGroupCallIncomingController1.setCallType("mws"),this.$FBRTCGroupCallIncomingController1.setActiveConnection("mws"),this.$FBRTCGroupCallIncomingController1.setRingRequestReceived()};a.prototype.$FBRTCGroupCallIncomingController7=function(a,c){"use strict";__p&&__p();this.$FBRTCGroupCallIncomingController1.onCallEnded(i.UNSUPPORTED_VERSION,!1);this.$FBRTCGroupCallIncomingController1.save(b("FBRTCCallSummaryStore").getInstance());if(this.$FBRTCGroupCallIncomingController2){var d=a.otherParticipants,e=a.caller,f=c+b("randomInt")(0,4294967295).toString();b("FBRTCUnsupportedBrowserMessage").showForIncomingGroupCall(c,d,e,f)}else{c=a.ringType;b("MessengerRTCUnsupportedBrowserDialogController").render({hasVideo:c===b("FBRTCRingType").GROUP_VIDEO_CALL||c===b("FBRTCRingType").PEER_VIDEO_CALL,isGroupCall:!0})}};a.prototype.$FBRTCGroupCallIncomingController8=function(){"use strict";this.$FBRTCGroupCallIncomingController1.onCallEnded(i.IGNORE_CALL,!1,!1,"calling disabled"),this.$FBRTCGroupCallIncomingController1.save(b("FBRTCCallSummaryStore").getInstance())};a.prototype.$FBRTCGroupCallIncomingController9=function(a,c){"use strict";__p&&__p();var d=b("nullthrows")(c.ringRequest()),e=b("nullthrows")(c.serverInfoData()),f=this.getParticipantsFromRingRequest(d,c.conferenceName(),a),g=f.caller;f=f.usersToRing;d=d.ringType===b("FBRTCRingType").GROUP_VIDEO_CALL||d.ringType===b("FBRTCRingType").PEER_VIDEO_CALL;var h=new this.$FBRTCGroupCallIncomingController3(c.conferenceName(),a,g,f,d,e);this.$FBRTCGroupCallIncomingController10(h,a,e,d,c,[g].concat(f));this.$FBRTCGroupCallIncomingController11(h,c,e);this.$FBRTCGroupCallIncomingController12(h,c,e);this.$FBRTCGroupCallIncomingController4=h;return this.$FBRTCGroupCallIncomingController4};a.prototype.$FBRTCGroupCallIncomingController10=function(a,c,d,e,f,g){"use strict";__p&&__p();a.addListener("answerCall",function(a,h){__p&&__p();this.$FBRTCGroupCallIncomingController1.onPressedAnswer();this.$FBRTCGroupCallIncomingController1.save(b("FBRTCCallSummaryStore").getInstance());k("MW answered ConferenceName: %o",f.conferenceName());var i="",j="";if(b("RTWebClientFeatureGating").canUseMultiwaySandbox()){var l,m=f.header().extensions;l=(l=m)!=null?l.multiwayWwwTier:l;m=(m=m)!=null?m.multiwayCoreTier:m;j=l?l:"";i=m?m:""}this.$FBRTCGroupCallIncomingController5({callSummary:this.$FBRTCGroupCallIncomingController1,conferenceName:a,callID:c,hasVideo:e,initializeVideo:h,multiwayCoreTier:i,multiwayWwwTier:j,serverInfoData:d,participantFBIDs:g})}.bind(this))};a.prototype.$FBRTCGroupCallIncomingController11=function(a,c,d){"use strict";a.addListener("ignoreCall",function(a){this.$FBRTCGroupCallIncomingController13(c,d,a?b("FBRTCHangupReason").IN_ANOTHER_CALL:b("FBRTCHangupReason").IGNORE_CALL,a?i.IN_ANOTHER_CALL:i.IGNORE_CALL,a)}.bind(this))};a.prototype.$FBRTCGroupCallIncomingController12=function(a,c,d){"use strict";a.addListener("timeout",function(a){this.$FBRTCGroupCallIncomingController13(c,d,b("FBRTCHangupReason").NO_ANSWER_TIMEOUT,i.NO_ANSWER_TIMEOUT,a)}.bind(this))};a.prototype.$FBRTCGroupCallIncomingController13=function(a,c,d,e,f){"use strict";f?b("RTCMWProtocolHandler").otherUserInAnotherCall(a.conferenceName(),c,d,this.$FBRTCGroupCallIncomingController1.callID):b("RTCMWProtocolHandler").endCall(a.conferenceName(),c,d),this.$FBRTCGroupCallIncomingController1.onCallEnded(e,!1),this.$FBRTCGroupCallIncomingController1.save(b("FBRTCCallSummaryStore").getInstance()),this.cancelIncomingCallDialog()};a.prototype.onBonfireMessageReceived=function(a){"use strict";b("BonfireNotificationUtils").sendRingAck(a);a=b("BonfireNotificationUtils").toFBRTCMessage(a);a&&this.onMessageReceived(a)};a.prototype.onMessageReceived=function(a){"use strict";__p&&__p();a=new(b("FBRTCMultiwayMessage"))(a);var c=this.getTransaction(a);b("promiseDone")(c.start().then(function(a){if(a!=null)if(a.ringRequest()!=null){var d=b("generateRTCCallID")();d=this.handleRingRequest(a,d);d&&b("promiseDone")(c.sendResponse(d),function(){this.$FBRTCGroupCallIncomingController1.setRingResponseSent()}.bind(this))}else a.dismissRequest()!=null?(k("MW msg.get type:%o conferenceName:%o %o",a.type(),a.conferenceName(),a.dismissRequest()),c.sendResponse(this.handleDismissRequest(a))):k("MW Incoming controller only handle ring and dismiss, dropping other message",a)}.bind(this),function(a){}))};a.prototype.setCustomAnswerHandler=function(a){"use strict";this.$FBRTCGroupCallIncomingController5=a};a.prototype.cancelIncomingCallDialog=function(){"use strict";this.$FBRTCGroupCallIncomingController4&&(this.$FBRTCGroupCallIncomingController4.cancel(),this.$FBRTCGroupCallIncomingController4=null)};a.prototype.handleDismissRequest=function(a){"use strict";b("MessengerRTCUnsupportedBrowserDialogController").hideDialog();if(this.$FBRTCGroupCallIncomingController4){var c=this.$FBRTCGroupCallIncomingController4.serverInfoData();c==a.serverInfoData()?this.cancelIncomingCallDialog():k("MW Received dismiss with different server info data")}return a.createResponse(b("FBRTCRtcResponseStatusCode").OK,{})};a.prototype.handleRingRequest=function(a,c){"use strict";__p&&__p();var d=b("nullthrows")(a.ringRequest());d!==null||g(0,4280);k("MW msg.get type:%o conferenceName:%o %o",a.type(),a.conferenceName(),a.ringRequest());if(!b("BonfireFeatureGating").canReceiveBonfireRingInterop()&&b("RTCUtils").isBonfireCall(a.conferenceName()))return null;var e=this.$FBRTCGroupCallIncomingController3.getHangUpReasonForNewRequest();if(e===b("FBRTCHangupReason").IN_ANOTHER_CALL){b("RTCMWProtocolHandler").otherUserInAnotherCall(a.conferenceName(),a.serverInfoData(),b("FBRTCHangupReason").IN_ANOTHER_CALL,c.toString());return null}this.$FBRTCGroupCallIncomingController6(c);if(b("FBRTCCallBlockingStore").getBlockingStatus()){this.$FBRTCGroupCallIncomingController8();return null}if(!b("FBRTCSupport").isGroupCallWebtrcSupported()){this.$FBRTCGroupCallIncomingController7(d,c);return null}if(a.serverInfoData()==null)return a.createResponse(b("FBRTCRtcResponseStatusCode").BAD_REQUEST,{callID:c.toString()});e=this.$FBRTCGroupCallIncomingController9(c,a);e.showIncomingDialog();d={deviceCapabilities:[b("FBRTCCapability").SUPPORT_AUDIO_DEPRECATED,b("FBRTCCapability").SUPPORT_VIDEO_DEPRECATED],deviceStatus:b("FBRTCDeviceStatus").OK};return a.createResponse(b("FBRTCRtcResponseStatusCode").OK,{body:{ringResponse:d},callID:c.toString()})};a.prototype.getParticipantsFromRingRequest=function(a,c,d){"use strict";__p&&__p();c=a.caller;var e=a.otherParticipants,f=a.appMessages;f&&f.forEach(function(f){__p&&__p();var g;g=(g=f)!=null?(g=g.body)!=null?(g=g.genericMessage)!=null?g.topic:g:g:g;f=(f=f)!=null?(f=f.body)!=null?(f=f.genericMessage)!=null?f.data:f:f:f;if(g==="aloha_proxying_as_users"&&f){g=a.caller;f=JSON.parse(f);var h=[];f[g].forEach(function(a){h.push(a.id.toString())});h.length>0?(c=h.shift(),e=h):b("FBRTCLogger").getInstance().logError(null,d,{err:"Failed to initialize aloha participants",proxyUserIDsWithProxyingAsUserIDs:f})}});return{caller:c,usersToRing:e}};function k(){}e.exports=a}),null);
__d("EnterMessengerCallRoomMutation.graphql",[],(function(a,b,c,d,e,f){"use strict";a=function(){var a=[{kind:"LocalArgument",name:"input",type:"EnterMessengerCallRoomData!",defaultValue:null}],b={kind:"ScalarField",alias:null,name:"id",args:null,storageKey:null};b=[{kind:"LinkedField",alias:null,name:"enter_messenger_call_room",storageKey:null,args:[{kind:"Variable",name:"data",variableName:"input",type:"EnterMessengerCallRoomData!"}],concreteType:"EnterMessengerCallRoomResponsePayload",plural:!1,selections:[{kind:"LinkedField",alias:null,name:"messenger_call_room",storageKey:null,args:null,concreteType:"MessengerCallRoom",plural:!1,selections:[b,{kind:"ScalarField",alias:null,name:"conference_name",args:null,storageKey:null},{kind:"LinkedField",alias:null,name:"room_message_thread",storageKey:null,args:null,concreteType:"MessengerGlobalGroupThread",plural:!1,selections:[b]}]}]}];return{kind:"Request",operationKind:"mutation",name:"EnterMessengerCallRoomMutation",id:"1650289558360123",text:null,metadata:{},fragment:{kind:"Fragment",name:"EnterMessengerCallRoomMutation",type:"Mutation",metadata:null,argumentDefinitions:a,selections:b},operation:{kind:"Operation",name:"EnterMessengerCallRoomMutation",argumentDefinitions:a,selections:b}}}();e.exports=a}),null);
__d("EnterMessengerCallRoomMutation",["Promise","RelayFBEnvironment","RelayModern","VideoChatLinksLoggingEvent","VideoChatLinksLoggingSurface","VideoChatLinksUserActionsTypedLogger","EnterMessengerCallRoomMutation.graphql"],(function(a,b,c,d,e,f){"use strict";__p&&__p();var g=b("RelayModern").commitMutation;b("RelayModern").graphql;var h=function(){return b("EnterMessengerCallRoomMutation.graphql")};function a(a){return new(b("Promise"))(function(c,d){g(b("RelayFBEnvironment"),{mutation:h,variables:{input:{room_link:a}},optimisticUpdater:null,onCompleted:function(a){var b;b=(b=a)!=null?(b=b.enter_messenger_call_room)!=null?(b=b.messenger_call_room)!=null?b.conference_name:b:b:b;a=(a=a)!=null?(a=a.enter_messenger_call_room)!=null?(a=a.messenger_call_room)!=null?(a=a.room_message_thread)!=null?a.id:a:a:a:a;b?c({conferenceName:b,threadFBID:a}):a?(i("Missing conferenceName"),c({conferenceName:"GROUP:"+a,threadFBID:a})):(i("Missing conferenceName and threadID"),d(new Error("Missing conference name and thread ID")))},onError:function(a){d(a)}})})}function i(a){new(b("VideoChatLinksUserActionsTypedLogger"))().setSurface(b("VideoChatLinksLoggingSurface").WWW_INTERSTITIAL).setEvent(b("VideoChatLinksLoggingEvent").ERROR).setErrorType("EnterRoomError").setErrorDetails(a).log()}e.exports=a}),null);
__d("RTCGroupCallIncomingDialogBodyQuery.graphql",[],(function(a,b,c,d,e,f){"use strict";a=function(){var a=[{kind:"LocalArgument",name:"id",type:"ID!",defaultValue:null}],b=[{kind:"Variable",name:"id",variableName:"id",type:"ID!"}],c={kind:"ScalarField",alias:null,name:"thread_name",args:null,storageKey:null},d={kind:"LinkedField",alias:null,name:"image",storageKey:null,args:null,concreteType:"Image",plural:!1,selections:[{kind:"ScalarField",alias:null,name:"uri",args:null,storageKey:null}]};return{kind:"Request",operationKind:"query",name:"RTCGroupCallIncomingDialogBodyQuery",id:"2094252340646537",text:null,metadata:{},fragment:{kind:"Fragment",name:"RTCGroupCallIncomingDialogBodyQuery",type:"Query",metadata:null,argumentDefinitions:a,selections:[{kind:"LinkedField",alias:null,name:"message_thread",storageKey:null,args:b,concreteType:"MessageThread",plural:!1,selections:[c,d]}]},operation:{kind:"Operation",name:"RTCGroupCallIncomingDialogBodyQuery",argumentDefinitions:a,selections:[{kind:"LinkedField",alias:null,name:"message_thread",storageKey:null,args:b,concreteType:"MessageThread",plural:!1,selections:[c,d,{kind:"ScalarField",alias:null,name:"id",args:null,storageKey:null}]}]}}}();e.exports=a}),null);
__d("VFWebCreateCallMutation.graphql",[],(function(a,b,c,d,e,f){"use strict";a=function(){var a=[{kind:"LocalArgument",name:"input",type:"MessengerCreateCallConferenceData!",defaultValue:null}],b=[{kind:"LinkedField",alias:null,name:"messenger_create_call_conference",storageKey:null,args:[{kind:"Variable",name:"data",variableName:"input",type:"MessengerCreateCallConferenceData!"}],concreteType:"MessengerCreateCallConferenceResponsePayload",plural:!1,selections:[{kind:"ScalarField",alias:null,name:"conference_name",args:null,storageKey:null}]}];return{kind:"Request",operationKind:"mutation",name:"VFWebCreateCallMutation",id:"1720220268047488",text:null,metadata:{},fragment:{kind:"Fragment",name:"VFWebCreateCallMutation",type:"Mutation",metadata:null,argumentDefinitions:a,selections:b},operation:{kind:"Operation",name:"VFWebCreateCallMutation",argumentDefinitions:a,selections:b}}}();e.exports=a}),null);
__d("VFWebIncomingCallDialogUtils_userQuery.graphql",[],(function(a,b,c,d,e,f){"use strict";a=function(){var a=[{kind:"LocalArgument",name:"user_ids",type:"[ID!]!",defaultValue:null},{kind:"LocalArgument",name:"thread_id",type:"ID!",defaultValue:null},{kind:"LocalArgument",name:"should_fetch_thread",type:"Boolean",defaultValue:!1},{kind:"LocalArgument",name:"picture_width",type:"Int",defaultValue:null},{kind:"LocalArgument",name:"picture_height",type:"Int",defaultValue:null}],b=[{kind:"Variable",name:"ids",variableName:"user_ids",type:"[ID!]!"}],c={kind:"ScalarField",alias:null,name:"id",args:null,storageKey:null},d={kind:"ScalarField",alias:null,name:"short_name",args:null,storageKey:null},e=[{kind:"ScalarField",alias:null,name:"uri",args:null,storageKey:null}],f={kind:"LinkedField",alias:null,name:"profile_picture",storageKey:null,args:[{kind:"Variable",name:"height",variableName:"picture_height",type:"Int"},{kind:"Variable",name:"width",variableName:"picture_width",type:"Int"}],concreteType:"Image",plural:!1,selections:e},g={kind:"ScalarField",alias:null,name:"name",args:null,storageKey:null},h=[{kind:"Variable",name:"id",variableName:"thread_id",type:"ID!"}],i={kind:"ScalarField",alias:null,name:"thread_name",args:null,storageKey:null};e={kind:"LinkedField",alias:null,name:"image",storageKey:null,args:null,concreteType:"Image",plural:!1,selections:e};return{kind:"Request",operationKind:"query",name:"VFWebIncomingCallDialogUtils_userQuery",id:"1976258499100083",text:null,metadata:{},fragment:{kind:"Fragment",name:"VFWebIncomingCallDialogUtils_userQuery",type:"Query",metadata:null,argumentDefinitions:a,selections:[{kind:"LinkedField",alias:null,name:"nodes",storageKey:null,args:b,concreteType:null,plural:!0,selections:[{kind:"InlineFragment",type:"User",selections:[c,d,f,g]}]},{kind:"Condition",passingValue:!0,condition:"should_fetch_thread",selections:[{kind:"LinkedField",alias:null,name:"message_thread",storageKey:null,args:h,concreteType:"MessageThread",plural:!1,selections:[i,e]}]}]},operation:{kind:"Operation",name:"VFWebIncomingCallDialogUtils_userQuery",argumentDefinitions:a,selections:[{kind:"LinkedField",alias:null,name:"nodes",storageKey:null,args:b,concreteType:null,plural:!0,selections:[{kind:"ScalarField",alias:null,name:"__typename",args:null,storageKey:null},c,{kind:"InlineFragment",type:"User",selections:[d,f,g]}]},{kind:"Condition",passingValue:!0,condition:"should_fetch_thread",selections:[{kind:"LinkedField",alias:null,name:"message_thread",storageKey:null,args:h,concreteType:"MessageThread",plural:!1,selections:[i,e,c]}]}]}}}();e.exports=a}),null);
__d("RungParticipantsAddedWebGraphQLSubscription",["WebGraphQLSubscriptionHelper"],(function(a,b,c,d,e,f){"use strict";e.exports=b("WebGraphQLSubscriptionHelper").getExports({docID:"1879396068740293",queryID:"738167736389860"})}),null);
__d("RungParticipantsAddedSubscription",["BaseGraphQLSubscription","RungParticipantsAddedWebGraphQLSubscription","uuid"],(function(a,b,c,d,e,f){__p&&__p();var g;g=babelHelpers.inherits(a,b("BaseGraphQLSubscription"));g&&g.prototype;a.prototype.getTopic=function(a){"use strict";return"gqls/"+this.getSubscriptionCallName()+"/call_id_"+a};a.prototype.getQueryID=function(){"use strict";return b("RungParticipantsAddedWebGraphQLSubscription").getDocID()};a.prototype.getQueryParameters=function(a){"use strict";return{input:JSON.stringify({client_subscription_id:b("uuid")(),call_id:a})}};a.prototype.getSubscriptionCallName=function(){"use strict";return"rung_participants_added_subscribe"};function a(){"use strict";g.apply(this,arguments)}e.exports=a}),null);
__d("VFWebUserActionsTypedLogger",["Banzai","GeneratedLoggerUtils","nullthrows"],(function(a,b,c,d,e,f){"use strict";__p&&__p();function a(){this.clear()}a.prototype.log=function(){b("GeneratedLoggerUtils").log("logger:VFWebUserActionsLoggerConfig",this.$1,b("Banzai").BASIC)};a.prototype.logVital=function(){b("GeneratedLoggerUtils").log("logger:VFWebUserActionsLoggerConfig",this.$1,b("Banzai").VITAL)};a.prototype.logImmediately=function(){b("GeneratedLoggerUtils").log("logger:VFWebUserActionsLoggerConfig",this.$1,{signal:!0})};a.prototype.clear=function(){this.$1={};return this};a.prototype.getData=function(){return babelHelpers["extends"]({},this.$1)};a.prototype.updateData=function(a){this.$1=babelHelpers["extends"]({},this.$1,a);return this};a.prototype.setCheckpoint=function(a){this.$1.checkpoint=a;return this};a.prototype.setClientTime=function(a){this.$1.client_time=a;return this};a.prototype.setComponent=function(a){this.$1.component=a;return this};a.prototype.setConferenceName=function(a){this.$1.conference_name=a;return this};a.prototype.setDeviceID=function(a){this.$1.device_id=a;return this};a.prototype.setDuration=function(a){this.$1.duration=a;return this};a.prototype.setErrorDetails=function(a){this.$1.error_details=a;return this};a.prototype.setErrorDomain=function(a){this.$1.error_domain=a;return this};a.prototype.setEvent=function(a){this.$1.event=a;return this};a.prototype.setEventExtra=function(a){this.$1.event_extra=b("GeneratedLoggerUtils").serializeMap(a);return this};a.prototype.setExpectedParticipantCount=function(a){this.$1.expected_participant_count=a;return this};a.prototype.setParticipantCount=function(a){this.$1.participant_count=a;return this};a.prototype.setSessionID=function(a){this.$1.session_id=a;return this};a.prototype.setSurface=function(a){this.$1.surface=a;return this};a.prototype.setTime=function(a){this.$1.time=a;return this};a.prototype.setVC=function(a){this.$1.vc=a;return this};a.prototype.setWeight=function(a){this.$1.weight=a;return this};c={checkpoint:!0,client_time:!0,component:!0,conference_name:!0,device_id:!0,duration:!0,error_details:!0,error_domain:!0,event:!0,event_extra:!0,expected_participant_count:!0,participant_count:!0,session_id:!0,surface:!0,time:!0,vc:!0,weight:!0};e.exports=a}),null);
__d("MessengerRTCIncomingDialog.react",["cx","fbt","ImageBlock.react","MessengerContactImageReact.bs","MessengerDialog.react","MessengerDialogBodyReact.bs","MessengerDialogButton.react","MessengerDialogFooter.react","MessengerDialogHeader.react","MessengerDialogs.bs","MessengerSpinner.react","React","RTWebLoggingCallType","RTWebLoggingComponent","RTWebLoggingSurface","RTWebUserActionLogger","VideoCallWebDriverIDs"],(function(a,b,c,d,e,f,g,h){"use strict";__p&&__p();var i=b("MessengerContactImageReact.bs").jsComponent,j=b("MessengerDialogBodyReact.bs").jsComponent;a=b("React").PropTypes;var k=50;c=b("React").createClass({displayName:"MessengerRTCIncomingDialog",propTypes:{callID:a.string.isRequired,callerParticipant:a.object.isRequired,onAccept:a.func.isRequired,onDecline:a.func.isRequired,isVideoCall:a.bool.isRequired},componentDidMount:function(){b("RTWebUserActionLogger").logPreCallImpression({callID:this.props.callID,callType:b("RTWebLoggingCallType").P2P,surface:b("RTWebLoggingSurface").INCOMING_DIALOG,mediaType:b("RTWebUserActionLogger").getMediaType(!this.props.isVideoCall)})},render:function(){return b("React").createElement(b("MessengerDialog.react"),{layerHideOnBlur:!1,shown:!0,onToggle:this._handleToggle,width:400},b("React").createElement(b("MessengerDialogHeader.react"),{className:"autofocus"},this._dialogTitle()),b("React").createElement(j,null,this._renderDialogBody()),b("React").createElement(b("MessengerDialogFooter.react"),null,b("React").createElement(b("MessengerDialogButton.react"),{label:h._("Decline"),onClick:this._handleDecline,dataTestID:b("VideoCallWebDriverIDs").IGNORE_CALL_BUTTON,type:"secondary"}),b("React").createElement(b("MessengerDialogButton.react"),{label:h._("Accept"),onClick:this._handleAccept,dataTestID:b("VideoCallWebDriverIDs").ANSWER_CALL_BUTTON,type:"primary"})))},_dialogTitle:function(){return this.props.isVideoCall?h._("Incoming Video Call"):h._("Incoming Audio Call")},_renderDialogBody:function(){var a=this.props.callerParticipant;return!a?b("React").createElement(b("MessengerSpinner.react"),null):b("React").createElement(b("ImageBlock.react"),null,b("React").createElement(i,{isMessengerUser:a.is_messenger_user,size:k,src:a.big_image_src||a.image_src}),b("React").createElement("div",{className:"_2n1r"},b("React").createElement("div",{className:"_2n1s"},h._("{caller name} is calling you.",[h._param("caller name",a.name)])),b("React").createElement("div",{className:"_2n1t"},h._("The call will start as soon as you answer."))))},_handleDecline:function(event){event.preventDefault(),b("MessengerDialogs.bs").removeAllDialogs(),this.props.onDecline(),b("RTWebUserActionLogger").logPreCallClick({callID:this.props.callID,callType:b("RTWebLoggingCallType").P2P,surface:b("RTWebLoggingSurface").INCOMING_DIALOG,component:b("RTWebLoggingComponent").DECLINE,mediaType:b("RTWebUserActionLogger").getMediaType(!this.props.isVideoCall)})},_handleAccept:function(event){event.preventDefault(),b("MessengerDialogs.bs").removeAllDialogs(),this.props.onAccept(this.props.isVideoCall),b("RTWebUserActionLogger").logPreCallClick({callID:this.props.callID,callType:b("RTWebLoggingCallType").P2P,surface:b("RTWebLoggingSurface").INCOMING_DIALOG,component:b("RTWebLoggingComponent").ACCEPT,mediaType:b("RTWebUserActionLogger").getMediaType(!this.props.isVideoCall)})},_handleToggle:function(a){a||(b("MessengerDialogs.bs").removeAllDialogs(),this.props.onDecline())}});e.exports=c}),null);
__d("RTCAcceptButton.react",["cx","fbt","MessengerDialogs.bs","React","RTCCallControlsButtonWithLabel.react","RTCCallStore","RTCUICameraIcon.react","RTCUIPhoneIcon.react","RTWebLoggingComponent","RTWebLoggingSurface","RTWebUserActionLogger","VideoCallWebDriverIDs"],(function(a,b,c,d,e,f,g,h){"use strict";__p&&__p();var i;c=babelHelpers.inherits(a,b("React").Component);i=c&&c.prototype;function a(){var a,c;for(var d=arguments.length,e=new Array(d),f=0;f<d;f++)e[f]=arguments[f];return c=(a=i.constructor).call.apply(a,[this].concat(e)),this.$1=function(){b("MessengerDialogs.bs").removeAllDialogs();this.props.onAccept();var a=b("RTWebUserActionLogger").getWebLoggerInfoFromStore(b("RTCCallStore").getState());b("RTWebUserActionLogger").logPreCallClick(babelHelpers["extends"]({},a,{callType:b("RTWebUserActionLogger").getCallType(!this.props.isP2P),surface:b("RTWebLoggingSurface").INCOMING_DIALOG,component:b("RTWebLoggingComponent").ACCEPT}))}.bind(this),c}a.prototype.componentDidMount=function(){var a=b("RTWebUserActionLogger").getWebLoggerInfoFromStore(b("RTCCallStore").getState());b("RTWebUserActionLogger").logPreCallImpression(babelHelpers["extends"]({},a,{callType:b("RTWebUserActionLogger").getCallType(!this.props.isP2P),component:b("RTWebLoggingComponent").ACCEPT,surface:b("RTWebLoggingSurface").INCOMING_DIALOG}))};a.prototype.render=function(){return b("React").createElement(b("RTCCallControlsButtonWithLabel.react"),{className:"_6jvd icon-40","data-testid":b("VideoCallWebDriverIDs").ANSWER_CALL_BUTTON,onClick:this.$1,shouldThrottle:!1,isVideoCall:this.props.isVideoCall,label:h._("Accept"),title:h._("Accept")},this.props.isVideoCall?b("React").createElement(b("RTCUICameraIcon.react"),null):b("React").createElement(b("RTCUIPhoneIcon.react"),{variant:"start call"}))};e.exports=a}),null);
__d("RTCDeclineButton.react",["cx","fbt","MessengerDialogs.bs","React","RTCCallControlsButtonWithLabel.react","RTCCallStore","RTCUIXIcon.react","RTWebLoggingComponent","RTWebLoggingSurface","RTWebUserActionLogger","VideoCallWebDriverIDs","joinClasses"],(function(a,b,c,d,e,f,g,h){"use strict";__p&&__p();var i;c=babelHelpers.inherits(a,b("React").Component);i=c&&c.prototype;function a(){var a,c;for(var d=arguments.length,e=new Array(d),f=0;f<d;f++)e[f]=arguments[f];return c=(a=i.constructor).call.apply(a,[this].concat(e)),this.$1=function(){b("MessengerDialogs.bs").removeAllDialogs(),this.props.onClick(),b("RTWebUserActionLogger").logPreCallClick({callID:b("RTCCallStore").getState().callInfo.callID,callType:b("RTWebUserActionLogger").getCallType(!this.props.isP2P),surface:b("RTWebLoggingSurface").INCOMING_DIALOG,component:b("RTWebLoggingComponent").DECLINE})}.bind(this),c}a.prototype.componentDidMount=function(){var a=b("RTWebUserActionLogger").getWebLoggerInfoFromStore(b("RTCCallStore").getState());b("RTWebUserActionLogger").logPreCallImpression(babelHelpers["extends"]({},a,{callType:b("RTWebUserActionLogger").getCallType(!this.props.isP2P),component:b("RTWebLoggingComponent").DECLINE,surface:b("RTWebLoggingSurface").INCOMING_DIALOG}))};a.prototype.render=function(){return b("React").createElement(b("RTCCallControlsButtonWithLabel.react"),{className:b("joinClasses")("_6jtv icon-40 icon-1",this.props.className),"data-testid":b("VideoCallWebDriverIDs").IGNORE_CALL_BUTTON,onClick:this.$1,label:h._("Decline"),title:h._("Decline")},b("React").createElement(b("RTCUIXIcon.react"),null))};e.exports=a}),null);
__d("RTCIncomingDialog.react",["cx","fbt","MessengerContactImageReact.bs","MessengerDialog.react","MessengerDialogBodyReact.bs","MessengerDialogs.bs","MessengerSpinner.react","React","RTCAcceptButton.react","RTCDeclineButton.react","RTWebClientFeatureGating","RTWebLoggingCallType","RTWebLoggingSurface","RTWebUserActionLogger"],(function(a,b,c,d,e,f,g,h){"use strict";__p&&__p();var i=b("MessengerContactImageReact.bs").jsComponent,j=b("MessengerDialogBodyReact.bs").jsComponent;a=b("React").PropTypes;var k=50;c=b("React").createClass({displayName:"RTCIncomingDialog",propTypes:{callID:a.string.isRequired,callerParticipant:a.object.isRequired,onAccept:a.func.isRequired,onDecline:a.func.isRequired,isVideoCall:a.bool.isRequired},componentDidMount:function(){b("RTWebUserActionLogger").logPreCallImpression({callID:this.props.callID,callType:b("RTWebLoggingCallType").P2P,surface:b("RTWebLoggingSurface").INCOMING_DIALOG,mediaType:b("RTWebUserActionLogger").getMediaType(!this.props.isVideoCall)})},render:function(){return b("React").createElement(b("MessengerDialog.react"),{className:"_6jvl",layerHideOnBlur:!1,onToggle:this._handleToggle,width:260},b("React").createElement(j,{className:"autofocus"},this._renderDialogBody()),b("React").createElement("div",{className:(this.props.isVideoCall&&b("RTWebClientFeatureGating").answerCallWithThreeButtons()?"_6nqr":"")+(!b("RTWebClientFeatureGating").answerCallWithThreeButtons()||!this.props.isVideoCall?" _6jvm":"")},b("React").createElement(b("RTCDeclineButton.react"),{isP2P:!0,onClick:this.props.onDecline}),b("RTWebClientFeatureGating").answerCallWithThreeButtons()||!this.props.isVideoCall?b("React").createElement(b("RTCAcceptButton.react"),{onAccept:function(){return this.props.onAccept(!1)}.bind(this),isVideoCall:!1,isP2P:!0}):null,this.props.isVideoCall?b("React").createElement(b("RTCAcceptButton.react"),{onAccept:function(){return this.props.onAccept(!0)}.bind(this),isVideoCall:!0,isP2P:!0}):null))},_dialogTitle:function(){return this.props.isVideoCall?h._("Incoming Video Chat"):h._("Incoming Call")},_renderDialogBody:function(){var a=this.props.callerParticipant;return!a?b("React").createElement(b("MessengerSpinner.react"),null):b("React").createElement("div",null,b("React").createElement(i,{className:"_6jvn",isMessengerUser:a.is_messenger_user,size:k,src:a.big_image_src||a.image_src}),b("React").createElement("div",{className:"_6jvo"},b("React").createElement("div",{className:"_6jvp"},h._("{caller name}",[h._param("caller name",a.name)])),this._dialogTitle()))},_handleToggle:function(a){a||(b("MessengerDialogs.bs").removeAllDialogs(),this.props.onDecline())}});e.exports=c}),null);
__d("MessengerRTCIncomingDialogController",["EventEmitter","FBRTCConstants","FBRTCExperiment","FBRTCSoundController","MercuryIDs","MessengerBrowserAlerts","MessengerDialogs.bs","MessengerParticipants.bs","MessengerRTCIncomingDialog.react","React","RTCIncomingDialog.react","RTWebClientFeatureGating","clearTimeout","setTimeoutAcrossTransitions"],(function(a,b,c,d,e,f){"use strict";__p&&__p();var g,h=7e4;c=babelHelpers.inherits(a,b("EventEmitter"));g=c&&c.prototype;function a(a,b){g.constructor.call(this),this.$MessengerRTCIncomingDialogController1=a,this.$MessengerRTCIncomingDialogController2=b,this.$MessengerRTCIncomingDialogController3=null,this.$MessengerRTCIncomingDialogController4=!1}a.getCallEndReasonForNewRequest=function(){return null};a.prototype.showIncomingDialog=function(a){this.$MessengerRTCIncomingDialogController5=b("setTimeoutAcrossTransitions")(this.$MessengerRTCIncomingDialogController6.bind(this),h);var c=a===b("FBRTCConstants").IncomingCallDialogTypes.VIDEO;b("FBRTCSoundController").playIncomingRingtone(this.$MessengerRTCIncomingDialogController2,this.$MessengerRTCIncomingDialogController1.toString(),{loop:!0,isP2P:!0});b("MessengerParticipants.bs").get(b("MercuryIDs").getParticipantIDFromUserID(this.$MessengerRTCIncomingDialogController1.toString()),function(a){var d=b("RTWebClientFeatureGating").useNewIncomingCallDialog()?b("React").createElement(b("RTCIncomingDialog.react"),{callID:this.$MessengerRTCIncomingDialogController2.toString(),callerParticipant:a,onAccept:this.$MessengerRTCIncomingDialogController7.bind(this),onDecline:this.$MessengerRTCIncomingDialogController8.bind(this),isVideoCall:c}):b("React").createElement(b("MessengerRTCIncomingDialog.react"),{callID:this.$MessengerRTCIncomingDialogController2.toString(),callerParticipant:a,onAccept:this.$MessengerRTCIncomingDialogController7.bind(this),onDecline:this.$MessengerRTCIncomingDialogController8.bind(this),isVideoCall:c});b("MessengerDialogs.bs").showDialog(function(){return d})}.bind(this));this.$MessengerRTCIncomingDialogController9()&&this.$MessengerRTCIncomingDialogController10(c)};a.prototype.$MessengerRTCIncomingDialogController9=function(){return!b("FBRTCExperiment").getIncomingCallExperiments().getBool("skip_desktop_notification",!1)};a.prototype.$MessengerRTCIncomingDialogController10=function(a){a={callID:this.$MessengerRTCIncomingDialogController2.toString(),peerID:this.$MessengerRTCIncomingDialogController1,onNotificationClicked:this.$MessengerRTCIncomingDialogController7.bind(this,a),isVideoCall:a,isGroupCall:!1};b("MessengerBrowserAlerts").showRTCNotification(a,function(a){this.$MessengerRTCIncomingDialogController3=a,this.$MessengerRTCIncomingDialogController4&&this.$MessengerRTCIncomingDialogController11()}.bind(this))};a.prototype.cancel=function(){this.$MessengerRTCIncomingDialogController5&&b("clearTimeout")(this.$MessengerRTCIncomingDialogController5),b("MessengerDialogs.bs").removeDialog(),b("FBRTCSoundController").stopIncomingRingtone(),this.$MessengerRTCIncomingDialogController11(),this.$MessengerRTCIncomingDialogController4=!0};a.prototype.isForPeer=function(a){return this.$MessengerRTCIncomingDialogController1===a};a.prototype.isForCall=function(a){return this.$MessengerRTCIncomingDialogController2===a};a.prototype.isForPeerAndCall=function(a,b){return this.$MessengerRTCIncomingDialogController1===a&&this.$MessengerRTCIncomingDialogController2===b};a.prototype.$MessengerRTCIncomingDialogController7=function(a){this.cancel(),this.emit("answerCall",this.$MessengerRTCIncomingDialogController2.toString(),a)};a.prototype.$MessengerRTCIncomingDialogController8=function(){this.cancel(),this.emit("ignoreCall",!1)};a.prototype.$MessengerRTCIncomingDialogController6=function(){this.cancel(),this.emit("timeout",!1)};a.prototype.$MessengerRTCIncomingDialogController11=function(){this.$MessengerRTCIncomingDialogController3&&(this.$MessengerRTCIncomingDialogController3.close(),this.$MessengerRTCIncomingDialogController3=null)};e.exports=a}),null);
__d("MessengerRTCMissedCallDialog.react",["cx","fbt","ImageBlock.react","MercuryIDs","MessengerContactImageReact.bs","MessengerDialog.react","MessengerDialogBodyReact.bs","MessengerDialogButton.react","MessengerDialogFooter.react","MessengerDialogHeader.react","MessengerDialogs.bs","MessengerDialogTitle.react","MessengerParticipants.bs","MessengerSpinner.react","React","RTWebLoggingCallType","RTWebLoggingComponent","RTWebLoggingMediaType","RTWebLoggingSurface","RTWebUserActionLogger","Timestamp.react"],(function(a,b,c,d,e,f,g,h){"use strict";__p&&__p();var i=b("MessengerContactImageReact.bs").jsComponent,j=b("MessengerDialogBodyReact.bs").jsComponent;a=b("React").PropTypes;var k=50,l=b("React").createClass({displayName:"MessengerRTCMissedCallDialog",_subscription:null,propTypes:{peerID:a.string.isRequired,timeMissed:a.number.isRequired},getInitialState:function(){return{calleeParticipant:null}},componentDidMount:function(){this._computeParticipant(),b("RTWebUserActionLogger").logPreCallImpression({callType:b("RTWebLoggingCallType").P2P,mediaType:b("RTWebLoggingMediaType").VIDEO,surface:b("RTWebLoggingSurface").MISSED_CALL_DIALOG,component:b("RTWebLoggingComponent").START_CALL})},componentDidUpdate:function(){this._subscription&&b("MessengerParticipants.bs").removeCallback(this._subscription);var a=b("MercuryIDs").getParticipantIDFromUserID(this.props.peerID);if(this.state.calleeParticipant&&this.state.calleeParticipant.id===a)return;this._computeParticipant()},componentWillUnmount:function(){this._subscription&&b("MessengerParticipants.bs").removeCallback(this._subscription)},_computeParticipant:function(){var a=b("MercuryIDs").getParticipantIDFromUserID(this.props.peerID),c=b("MessengerParticipants.bs").getNow(a);c?this.setState({calleeParticipant:c}):this._subscription=b("MessengerParticipants.bs").getMulti([a],function(b){this._subscription=null,this.setState({calleeParticipant:b[a]})}.bind(this))},render:function(){return b("React").createElement(b("MessengerDialog.react"),{layerHideOnBlur:!0,onToggle:this._handleToggle,shown:!0,width:400},b("React").createElement(b("MessengerDialogHeader.react"),null,b("React").createElement(b("MessengerDialogTitle.react"),null,h._("Missed Call"))),b("React").createElement(j,null,this._renderBody()),b("React").createElement(b("MessengerDialogFooter.react"),null,b("React").createElement(b("MessengerDialogButton.react"),{label:h._("Close"),onClick:this._handleClose,type:"secondary",use:"default"}),b("React").createElement(b("MessengerDialogButton.react"),{label:h._("Call Back"),onClick:this._handleCallBack,type:"primary",use:"default"})))},_renderBody:function(){var a=this.state.calleeParticipant;return!a?b("React").createElement(b("MessengerSpinner.react"),null):b("React").createElement(b("ImageBlock.react"),null,b("React").createElement(i,{isMessengerUser:a.is_messenger_user,size:k,src:a.big_image_src||a.image_src}),b("React").createElement("div",{className:"_2r2t"},b("React").createElement("div",{className:"_2r2u"},h._("You missed a call from {caller name}",[h._param("caller name",a.name)])),b("React").createElement("div",{className:"_2r2v"},b("React").createElement(b("Timestamp.react"),{time:this.props.timeMissed,autoUpdate:!0}))))},_handleCallBack:function(event){event.preventDefault();b("MessengerDialogs.bs").removeDialog(l);var a=this.state.calleeParticipant,c=a&&a.fbid;if(!c)return;d(["FBRTCCore"],function(a){a.startOutgoingCall(c,"messenger_dot_com_missed_call_dialog",!1)})},_handleClose:function(event){event.preventDefault(),b("MessengerDialogs.bs").removeDialog(l)},_handleToggle:function(a){a||b("MessengerDialogs.bs").removeDialog(l)}});e.exports=l}),null);
__d("RTCCloseDialogButton.react",["cx","fbt","React","RTCCallControlsButtonWithLabel.react","RTCCallStore","RTCUIXIcon.react","RTWebLoggingCallType","RTWebLoggingComponent","RTWebLoggingSurface","RTWebUserActionLogger","VideoCallWebDriverIDs"],(function(a,b,c,d,e,f,g,h){"use strict";__p&&__p();var i;c=babelHelpers.inherits(a,b("React").Component);i=c&&c.prototype;function a(){var a,c;for(var d=arguments.length,e=new Array(d),f=0;f<d;f++)e[f]=arguments[f];return c=(a=i.constructor).call.apply(a,[this].concat(e)),this.$1=function(){this.props.action(),b("RTWebUserActionLogger").logPreCallClick({callID:b("RTCCallStore").getState().callInfo.callID,callType:b("RTWebLoggingCallType").P2P,surface:b("RTWebLoggingSurface").MISSED_CALL_DIALOG,component:b("RTWebLoggingComponent").CLOSE_DIALOG})}.bind(this),c}a.prototype.componentDidMount=function(){var a=b("RTWebUserActionLogger").getWebLoggerInfoFromStore(b("RTCCallStore").getState());b("RTWebUserActionLogger").logPreCallImpression(babelHelpers["extends"]({},a,{callType:b("RTWebLoggingCallType").P2P,component:b("RTWebLoggingComponent").CLOSE_DIALOG,surface:b("RTWebLoggingSurface").MISSED_CALL_DIALOG}))};a.prototype.render=function(){return b("React").createElement(b("RTCCallControlsButtonWithLabel.react"),{className:"_6jtv icon-40 icon-1","data-testid":b("VideoCallWebDriverIDs").CLOSE_CHAT_BUTTON,onClick:this.$1,label:h._("Close"),title:h._("Close")},b("React").createElement(b("RTCUIXIcon.react"),null))};e.exports=a}),null);
__d("RTWebCallBackButton.react",["cx","fbt","FBLogger","React","RTCCallControlsButtonWithLabel.react","RTCCallStore","RTCUICameraIcon.react","RTWebCallTriggerMapping","RTWebLoggingCallType","RTWebUserActionLogger","VideoCallWebDriverIDs"],(function(a,b,c,d,e,f,g,h){"use strict";__p&&__p();var i;i=babelHelpers.inherits(a,b("React").Component);i&&i.prototype;a.prototype.componentDidMount=function(){var a=b("RTWebUserActionLogger").getWebLoggerInfoFromStore(b("RTCCallStore").getState()),c=b("RTWebCallTriggerMapping")[this.props.trigger];(c===null||c===undefined)&&b("FBLogger")("rtweb").mustfix("Unexpected or unknown call trigger: %s",c);b("RTWebUserActionLogger").logPreCallImpression(babelHelpers["extends"]({},a,c,{callType:b("RTWebLoggingCallType").P2P}))};a.prototype.render=function(){return b("React").createElement(b("RTCCallControlsButtonWithLabel.react"),{className:"_6jvj icon-40","data-testid":b("VideoCallWebDriverIDs").IGNORE_CALL_BUTTON,onClick:this.props.onCallBack,label:h._("Redial"),title:h._("Redial")},b("React").createElement(b("RTCUICameraIcon.react"),null))};function a(){i.apply(this,arguments)}e.exports=a}),null);
__d("RTCMissedCallDialog.react",["cx","fbt","MercuryIDs","MessengerContactImageReact.bs","MessengerDialog.react","MessengerDialogBodyReact.bs","MessengerDialogs.bs","MessengerParticipants.bs","MessengerSpinner.react","React","RTCCloseDialogButton.react","RTWebCallBackButton.react","Timestamp.react"],(function(a,b,c,d,e,f,g,h){"use strict";__p&&__p();var i=b("MessengerContactImageReact.bs").jsComponent,j=b("MessengerDialogBodyReact.bs").jsComponent;a=b("React").PropTypes;var k=50,l=b("React").createClass({displayName:"RTCMissedCallDialog",_subscription:null,propTypes:{peerID:a.string.isRequired,timeMissed:a.number.isRequired},getInitialState:function(){return{calleeParticipant:null}},componentDidMount:function(){this._computeParticipant()},componentDidUpdate:function(){this._subscription&&b("MessengerParticipants.bs").removeCallback(this._subscription);var a=b("MercuryIDs").getParticipantIDFromUserID(this.props.peerID);if(this.state.calleeParticipant&&this.state.calleeParticipant.id===a)return;this._computeParticipant()},componentWillUnmount:function(){this._subscription&&b("MessengerParticipants.bs").removeCallback(this._subscription)},_computeParticipant:function(){var a=b("MercuryIDs").getParticipantIDFromUserID(this.props.peerID),c=b("MessengerParticipants.bs").getNow(a);c?this.setState({calleeParticipant:c}):this._subscription=b("MessengerParticipants.bs").getMulti([a],function(b){this._subscription=null,this.setState({calleeParticipant:b[a]})}.bind(this))},render:function(){return b("React").createElement(b("MessengerDialog.react"),{className:"_6jve",layerHideOnBlur:!0,onToggle:this._handleToggle,shown:!0,width:260},b("React").createElement(j,null,this._renderBody()),b("React").createElement("div",{className:"_6jvf"},b("React").createElement(b("RTCCloseDialogButton.react"),{action:this._Action,isP2P:!0}),b("React").createElement(b("RTWebCallBackButton.react"),{onCallBack:this._handleCallBack,trigger:"messenger_dot_com_missed_call_dialog"})))},_renderBody:function(){var a=this.state.calleeParticipant;return!a?b("React").createElement(b("MessengerSpinner.react"),null):b("React").createElement("div",null,b("React").createElement(i,{className:"_6jvg",isMessengerUser:a.is_messenger_user,size:k,src:a.big_image_src||a.image_src}),b("React").createElement("div",{className:"_6jvh"},b("React").createElement("div",{className:"_6jvi"},h._("You missed a call from {caller name}",[h._param("caller name",a.name)])),b("React").createElement("div",{className:"_2r2v"},b("React").createElement(b("Timestamp.react"),{time:this.props.timeMissed,autoUpdate:!0}))))},_Action:function(){b("MessengerDialogs.bs").removeDialog()},_handleCallBack:function(){b("MessengerDialogs.bs").removeDialog();var a=this.state.calleeParticipant,c=a&&a.fbid;if(!c)return;d(["FBRTCCore"],function(a){a.startOutgoingCall(c,"messenger_dot_com_missed_call_dialog",!1)})},_handleToggle:function(a){a||b("MessengerDialogs.bs").removeDialog(l)}});e.exports=l}),null);
__d("MessengerRTCMissedCallDialogController",["MessengerDialogs.bs","MessengerRTCMissedCallDialog.react","React","RTCMissedCallDialog.react","RTWebClientFeatureGating"],(function(a,b,c,d,e,f){"use strict";a={onCallMissed:function(a){this._missedCallPeerID=a},showDialog:function(){if(!this._missedCallPeerID)return;var a=b("RTWebClientFeatureGating").useNewIncomingCallDialog()?b("React").createElement(b("RTCMissedCallDialog.react"),{peerID:this._missedCallPeerID.toString(),timeMissed:Date.now()}):b("React").createElement(b("MessengerRTCMissedCallDialog.react"),{peerID:this._missedCallPeerID.toString(),timeMissed:Date.now()});b("MessengerDialogs.bs").showDialog(function(){return a})},hideDialog:b("MessengerDialogs.bs").removeAllDialogs};e.exports=a}),null);
__d("MessengerRTCBonfireIncomingCall.react",["cx","fbt","BonfireLogger","BonfireUserFetcher","CurrentUser","Facepile.react","ImageBlock.react","MessengerContactImage.react","MessengerDialog.react","MessengerDialogBody.react","MessengerDialogButton.react","MessengerDialogFooter.react","MessengerDialogHeader.react","MessengerDialogs.bs","MessengerSpinner.react","React","immutable","promiseDone"],(function(a,b,c,d,e,f,g,h){"use strict";__p&&__p();var i,j=50,k=5;c=babelHelpers.inherits(a,b("React").Component);i=c&&c.prototype;function a(){var a,c;for(var d=arguments.length,e=new Array(d),f=0;f<d;f++)e[f]=arguments[f];return c=(a=i.constructor).call.apply(a,[this].concat(e)),this.state={callerParticipant:null,participants:b("immutable").Map()},this.$4=function(event){event.preventDefault(),b("MessengerDialogs.bs").removeAllDialogs(),this.props.onDecline(),b("BonfireLogger").logClick("messenger_ring_dialog","ignore_ring")}.bind(this),this.$5=function(event){event.preventDefault(),b("MessengerDialogs.bs").removeAllDialogs(),this.props.onAccept(),b("BonfireLogger").logClick("messenger_ring_dialog","accept_ring")}.bind(this),this.$1=function(a){a||(b("MessengerDialogs.bs").removeAllDialogs(),this.props.onDecline())}.bind(this),c}a.prototype.componentDidMount=function(){b("promiseDone")(b("BonfireUserFetcher").fetchAllParticipants(b("immutable").Set(this.props.participantIDs)),function(a){this.setState({callerParticipant:a.find(function(a){return a&&a.fbid===this.props.callerID}.bind(this)),participants:a.filter(Boolean).filter(function(a){return a.fbid!==this.props.callerID}.bind(this))})}.bind(this)),b("BonfireLogger").logImpression("messenger_ring_dialog")};a.prototype.render=function(){return b("React").createElement(b("MessengerDialog.react"),{layerHideOnBlur:!1,shown:!0,onToggle:this.$1,width:400},b("React").createElement(b("MessengerDialogHeader.react"),null,this.$2()),b("React").createElement(b("MessengerDialogBody.react"),null,this.$3()),b("React").createElement(b("MessengerDialogFooter.react"),null,b("React").createElement(b("MessengerDialogButton.react"),{use:"default",label:h._("Decline"),onClick:this.$4,type:"secondary"}),b("React").createElement(b("MessengerDialogButton.react"),{use:"default",label:h._("Accept"),onClick:this.$5,type:"primary"})))};a.prototype.$2=function(){return b("CurrentUser").isWorkUser()?h._("Incoming Workplace Meet Group Video Call"):h._("Incoming Bonfire Video Chat")};a.prototype.$3=function(){var a=this.state.callerParticipant,c=this.state.participants.valueSeq().toArray();return!a?b("React").createElement(b("MessengerSpinner.react"),null):b("React").createElement(b("ImageBlock.react"),null,b("React").createElement(b("MessengerContactImage.react"),{isMessengerUser:a.is_messenger_user,size:j,src:a.big_image_src||a.image_src}),b("React").createElement("div",{className:"_2n1r"},b("React").createElement("div",{className:"_2n1s"},h._("{caller name} is calling you.",[h._param("caller name",a.name)])),b("React").createElement(b("Facepile.react"),{moreCount:Math.max(0,c.length-k),profiles:c.map(function(a){var b=a.name,c=a.fbid;a=a.big_image_src;return{name:b,uniqueID:c,profilePicURI:a}}).slice(0,k),size:"medium"}),b("React").createElement("div",{className:"_2n1t"},h._("The call will start as soon as you answer."))))};e.exports=a}),null);
__d("MessengerRTCGroupCallIncomingDialog.react",["cx","fbt","Facepile.react","ImageBlock.react","MercuryIDs","MessengerContactImageReact.bs","MessengerDialog.react","MessengerDialogBodyReact.bs","MessengerDialogButton.react","MessengerDialogFooter.react","MessengerDialogHeader.react","MessengerDialogs.bs","MessengerParticipants.bs","React","RTWebLoggingCallType","RTWebLoggingComponent","RTWebLoggingSurface","RTWebUserActionLogger","RungParticipantsAddedSubscription","VideoCallWebDriverIDs","gkx","immutable"],(function(a,b,c,d,e,f,g,h){"use strict";__p&&__p();var i,j=b("MessengerContactImageReact.bs").jsComponent,k=b("MessengerDialogBodyReact.bs").jsComponent,l=400,m=5,n=50,o=function(a,b){a?a=b?h._("Incoming Group Video Chat"):h._("Incoming Group Call"):a=b?h._("Incoming Video Chat"):h._("Incoming Call");return a},p=function(a,b,c,d){d<=1?d=b?h._("{caller name} invited you to a video chat.",[h._param("caller name",c.name)]):h._("{caller name} invited you to a call.",[h._param("caller name",c.name)]):a?d=b?h._("{caller name} started a group video chat in a group you're a member of.",[h._param("caller name",c.name)]):h._("{caller name} started a group call in a group you're a member of.",[h._param("caller name",c.name)]):d=b?h._("{caller name} invited you to a group video chat.",[h._param("caller name",c.name)]):h._("{caller name} invited you to a group call.",[h._param("caller name",c.name)]);return d},q=function(a){var c=a.isGroupCall;a=a.hasVideo;return b("React").createElement(b("MessengerDialogHeader.react"),{className:"autofocus"},o(c,a))},r=function(a){var c=a.isGroupCall,d=a.hasVideo,e=a.caller;a=a.callees;return b("React").createElement(k,null,b("React").createElement(b("ImageBlock.react"),null,b("React").createElement(j,{isMessengerUser:e.is_messenger_user,size:n,src:e.big_image_src||e.image_src}),b("React").createElement("div",{className:"_2n1r"},b("React").createElement("div",{className:"_2n1s"},p(c,d,e,a.length)),b("React").createElement(b("Facepile.react"),{moreCount:Math.max(0,a.length-m),profiles:a.map(function(a){var b=a.name,c=a.fbid;a=a.big_image_src;return{name:b,uniqueID:c,profilePicURI:a}}).slice(0,m),size:"medium"}),b("React").createElement("div",{className:"_2n1t"},b("gkx")("678352")&&s(a)?h._("This group includes people you've blocked."):d?h._("Video will start as soon as you answer."):h._("The call will start as soon as you answer.")))))},s=function(a){return a.some(function(a){return a.is_messenger_blocked||a.is_facebook_blocked})},t=function(a,c,d,e){b("MessengerDialogs.bs").removeAllDialogs(),a(),b("RTWebUserActionLogger").logPreCallClick({callID:d,callType:b("RTWebLoggingCallType").MW,conferenceName:e,surface:b("RTWebLoggingSurface").INCOMING_DIALOG,component:b("RTWebLoggingComponent").DECLINE,mediaType:b("RTWebUserActionLogger").getMediaType(!c)})},u=function(a,c,d,e){b("MessengerDialogs.bs").removeAllDialogs(),a(),b("RTWebUserActionLogger").logPreCallClick({callID:d,callType:b("RTWebLoggingCallType").MW,conferenceName:e,surface:b("RTWebLoggingSurface").INCOMING_DIALOG,component:b("RTWebLoggingComponent").ACCEPT,mediaType:b("RTWebUserActionLogger").getMediaType(!c)})},v=function(a,c){a||(b("MessengerDialogs.bs").removeAllDialogs(),c())};c=babelHelpers.inherits(a,b("React").Component);i=c&&c.prototype;function a(a){i.constructor.call(this,a),this.$2=null,this.$3()}a.prototype.componentDidMount=function(){b("MessengerParticipants.bs").getMulti(this.props.participantIDs.map(b("MercuryIDs").getParticipantIDFromUserID),function(a){var c=b("immutable").Map(a).filter(function(a){return a.id!=this.props.callerID&&!a.is_aloha_proxy_confirmed}.bind(this));this.$1=a[this.props.callerID];this.setState({rungParticipants:c})}.bind(this)),b("RTWebUserActionLogger").logPreCallImpression({callID:this.props.callID,callType:b("RTWebLoggingCallType").MW,conferenceName:this.props.conferenceName,surface:b("RTWebLoggingSurface").INCOMING_DIALOG,mediaType:b("RTWebUserActionLogger").getMediaType(!this.props.hasVideo)})};a.prototype.$3=function(){__p&&__p();var a=this.props.conferenceName.split(":")[1];this.$2=b("RungParticipantsAddedSubscription").subscribe(a,function(a){__p&&__p();a=a.rung_participants_added_subscribe.call.rung_participants.edges;if(a.length>this.state.rungParticipants.size){a=a.map(function(a){a=a.node.id;return b("MercuryIDs").getParticipantIDFromUserID(a)}).filter(function(a){return!this.state.rungParticipants.has(a)}.bind(this));b("MessengerParticipants.bs").getMulti(a,function(a){a=this.state.rungParticipants.concat(a);this.setState({rungParticipants:a})}.bind(this))}}.bind(this))};a.prototype.componentWillUnmount=function(){if(!this.$2)return;this.$2.unsubscribe();this.$2=null};a.prototype.render=function(){if(!this.$1)return null;var a=this.props,c=a.hasVideo,d=a.isGroupCall,e=a.onIgnore,f=a.onAnswer,g=a.callID,i=a.conferenceName;return b("React").createElement(b("MessengerDialog.react"),{layerHideOnBlur:!1,shown:!0,onToggle:function(a){return v(a,e)},width:l},b("React").createElement(q,{hasVideo:c,isGroupCall:d&&this.state.rungParticipants.size>1}),b("React").createElement(r,{isGroupCall:d,hasVideo:c,caller:this.$1,callees:this.state.rungParticipants.valueSeq().toArray()}),b("React").createElement(b("MessengerDialogFooter.react"),null,b("React").createElement(b("MessengerDialogButton.react"),{label:h._("Ignore"),onClick:function(){return t(e,c,g,i)},dataTestID:b("VideoCallWebDriverIDs").IGNORE_CALL_BUTTON,type:"secondary"}),b("React").createElement(b("MessengerDialogButton.react"),{label:h._("Answer Call"),onClick:function(){return u(function(){return f(c)},c,g,i)},dataTestID:b("VideoCallWebDriverIDs").ANSWER_CALL_BUTTON,type:"primary"})))};e.exports=a}),null);
__d("RTCGroupCallIncomingDialogBody.react",["cx","fbt","MessengerDialogBodyReact.bs","MessengerProfileImageWrapperReact.bs","MessengerSpinner.react","React","RelayFBEnvironment","RelayModern","RTCUtils","SplitImage.react","intlList","RTCGroupCallIncomingDialogBodyQuery.graphql"],(function(a,b,c,d,e,f,g,h){"use strict";__p&&__p();var i,j=b("MessengerDialogBodyReact.bs").jsComponent,k=b("MessengerProfileImageWrapperReact.bs").jsComponent,l=b("RelayModern").QueryRenderer;b("RelayModern").graphql;var m=50,n=function(){return b("RTCGroupCallIncomingDialogBodyQuery.graphql")},o=function(a){return h._("{names of users showed on group call incoming dialog}",[h._param("names of users showed on group call incoming dialog",a)])},p=function(a,b,c){a=b?h._("{caller name} wants you to join a group video chat.",[h._param("caller name",c.short_name)]):h._("{caller name} wants you to join a group call.",[h._param("caller name",c.short_name)]);return a},q=function(a){__p&&__p();var c=a.isGroupCall,d=a.hasVideo,e=a.caller,f=a.callees,g=a.conferenceName,h=Array.of(e.image_src).concat(Array.from(f.map(function(a){return a.image_src}))),i=b("intlList")(Array.of(e.short_name).concat(Array.from(f.map(function(a){return a.short_name}))),b("intlList").CONJUNCTIONS.AND).toString();return b("RTCUtils").getThreadID(g)===null?b("React").createElement(r,{isGroupCall:c,hasVideo:d,image:h,groupName:i,conferenceName:g}):b("React").createElement(l,{environment:b("RelayFBEnvironment"),query:n,variables:{id:b("RTCUtils").getThreadID(g)},render:function(a){__p&&__p();var e=a.error;a=a.props;if(e)return b("React").createElement("div",null,e.message);else if(a){e=a.message_thread.image!==null&&a.message_thread.image.uri!==null?Array.of(a.message_thread.image.uri):h;a=a.message_thread.thread_name===null?i:a.message_thread.thread_name;return b("React").createElement(r,{isGroupCall:c,hasVideo:d,image:e,groupName:a,conferenceName:g})}return b("React").createElement(j,null,b("React").createElement("div",{className:"_6jvn"},b("React").createElement(b("MessengerSpinner.react"),{className:"_6lgz",color:"blue"})))}})},r=function(a){a.isGroupCall;a.hasVideo;var c=a.image,d=a.groupName;a.conferenceName;return b("React").createElement("div",null,b("React").createElement("div",{className:"_6jvn"},b("React").createElement(k,{className:"_4j_j",showBadge:!1,size:m},b("React").createElement(b("SplitImage.react"),{border:!0,className:"_4j_j",srcs:c,size:m,halfView:!0}))),b("React").createElement("div",{className:"_6jvz"},o(d)))};i=babelHelpers.inherits(a,b("React").Component);i&&i.prototype;a.prototype.render=function(){return b("React").createElement(j,{className:"autofocus"},b("React").createElement(q,{isGroupCall:this.props.isGroupCall,hasVideo:this.props.hasVideo,caller:this.props.caller,callees:this.props.callees,conferenceName:this.props.conferenceName}),b("React").createElement("div",{className:"_6jw4"},p(this.props.isGroupCall,this.props.hasVideo,this.props.caller)))};function a(){i.apply(this,arguments)}e.exports=a}),null);
__d("RTCGroupCallIncomingDialog.react",["cx","MercuryIDs","MessengerDialog.react","MessengerDialogs.bs","MessengerParticipants.bs","React","RTCAcceptButton.react","RTCDeclineButton.react","RTCGroupCallIncomingDialogBody.react","RTWebClientFeatureGating","RTWebLoggingCallType","RTWebLoggingSurface","RTWebUserActionLogger","RungParticipantsAddedSubscription","immutable"],(function(a,b,c,d,e,f,g){"use strict";__p&&__p();var h,i=260,j=function(a,c){a||(b("MessengerDialogs.bs").removeAllDialogs(),c())};c=babelHelpers.inherits(a,b("React").Component);h=c&&c.prototype;function a(a){h.constructor.call(this,a),this.$2=null,this.$3()}a.prototype.componentDidMount=function(){b("MessengerParticipants.bs").getMulti(this.props.participantIDs.map(b("MercuryIDs").getParticipantIDFromUserID),function(a){var c=b("immutable").Map(a).filter(function(a){return a.id!=this.props.callerID}.bind(this));this.$1=a[this.props.callerID];this.setState({rungParticipants:c})}.bind(this)),b("RTWebUserActionLogger").logPreCallImpression({callID:this.props.callID,callType:b("RTWebLoggingCallType").MW,conferenceName:this.props.conferenceName,surface:b("RTWebLoggingSurface").INCOMING_DIALOG,mediaType:b("RTWebUserActionLogger").getMediaType(!this.props.hasVideo)})};a.prototype.$3=function(){__p&&__p();var a=this.props.conferenceName.split(":")[1];this.$2=b("RungParticipantsAddedSubscription").subscribe(a,function(a){__p&&__p();a=a.rung_participants_added_subscribe.call.rung_participants.edges;if(a.length>this.state.rungParticipants.size){a=a.map(function(a){a=a.node.id;return b("MercuryIDs").getParticipantIDFromUserID(a)}).filter(function(a){return!this.state.rungParticipants.has(a)}.bind(this));b("MessengerParticipants.bs").getMulti(a,function(a){a=this.state.rungParticipants.concat(a);this.setState({rungParticipants:a})}.bind(this))}}.bind(this))};a.prototype.componentWillUnmount=function(){if(!this.$2)return;this.$2.unsubscribe();this.$2=null};a.prototype.render=function(){return!this.$1?null:b("React").createElement(b("MessengerDialog.react"),{className:"_6jvl",layerHideOnBlur:!1,shown:!0,onToggle:function(a){return j(a,this.props.onIgnore)}.bind(this),width:i},b("React").createElement(b("RTCGroupCallIncomingDialogBody.react"),{isGroupCall:this.props.isGroupCall,hasVideo:this.props.hasVideo,caller:this.$1,callees:this.state.rungParticipants.valueSeq().toArray(),conferenceName:this.props.conferenceName}),b("React").createElement("div",{className:(this.props.hasVideo&&b("RTWebClientFeatureGating").answerCallWithThreeButtons()?"_6nqr":"")+(!b("RTWebClientFeatureGating").answerCallWithThreeButtons()||!this.props.hasVideo?" _6jvm":"")},b("React").createElement(b("RTCDeclineButton.react"),{isP2P:!1,onClick:this.props.onIgnore}),b("RTWebClientFeatureGating").answerCallWithThreeButtons()||!this.props.hasVideo?b("React").createElement(b("RTCAcceptButton.react"),{onAccept:function(){this.props.onAnswer(!1)}.bind(this),isVideoCall:!1,isP2P:!1}):null,this.props.hasVideo?b("React").createElement(b("RTCAcceptButton.react"),{onAccept:function(){this.props.onAnswer(!0)}.bind(this),isVideoCall:!0,isP2P:!1}):null))};e.exports=a}),null);
__d("MessengerRTCGroupCallIncomingDialogController",["EventEmitter","FBRTCSoundController","MercuryIDs","MessengerBrowserAlerts","MessengerDialogs.bs","MessengerParticipants.bs","MessengerRTCBonfireIncomingCall.react","MessengerRTCGroupCallIncomingDialog.react","MessengerRTCIncomingDialog.react","React","RTCGroupCallIncomingDialog.react","RTCUtils","RTWebClientFeatureGating","clearTimeout","setTimeoutAcrossTransitions"],(function(a,b,c,d,e,f){"use strict";__p&&__p();var g,h=7e4;c=babelHelpers.inherits(a,b("EventEmitter"));g=c&&c.prototype;function a(a,b,c,d,e,f){g.constructor.call(this),this.$MessengerRTCGroupCallIncomingDialogController11=function(a){a===void 0&&(a=this.$MessengerRTCGroupCallIncomingDialogController5),this.cancel(),this.emit("answerCall",this.$MessengerRTCGroupCallIncomingDialogController1,a)}.bind(this),this.$MessengerRTCGroupCallIncomingDialogController1=a,this.$MessengerRTCGroupCallIncomingDialogController2=b,this.$MessengerRTCGroupCallIncomingDialogController3=c,this.$MessengerRTCGroupCallIncomingDialogController4=d,this.$MessengerRTCGroupCallIncomingDialogController5=e,this.$MessengerRTCGroupCallIncomingDialogController6=f,this.$MessengerRTCGroupCallIncomingDialogController7=null,this.$MessengerRTCGroupCallIncomingDialogController8=null,this.$MessengerRTCGroupCallIncomingDialogController9=!1}a.getHangUpReasonForNewRequest=function(){return null};a.prototype.serverInfoData=function(){return this.$MessengerRTCGroupCallIncomingDialogController6};a.prototype.showIncomingDialog=function(){__p&&__p();this.$MessengerRTCGroupCallIncomingDialogController7=b("setTimeoutAcrossTransitions")(this.$MessengerRTCGroupCallIncomingDialogController10.bind(this),h);b("FBRTCSoundController").playIncomingRingtone(this.$MessengerRTCGroupCallIncomingDialogController2,this.$MessengerRTCGroupCallIncomingDialogController1,{loop:!0,isP2P:!1});if(b("RTCUtils").isBonfireCall(this.$MessengerRTCGroupCallIncomingDialogController1)){var a=[this.$MessengerRTCGroupCallIncomingDialogController3].concat(this.$MessengerRTCGroupCallIncomingDialogController4);b("MessengerDialogs.bs").showDialog(function(){return b("React").createElement(b("MessengerRTCBonfireIncomingCall.react"),{callerID:this.$MessengerRTCGroupCallIncomingDialogController3,conferenceName:this.$MessengerRTCGroupCallIncomingDialogController1,onAccept:function(){return this.$MessengerRTCGroupCallIncomingDialogController11()}.bind(this),onDecline:function(){return this.$MessengerRTCGroupCallIncomingDialogController12()}.bind(this),participantIDs:a})}.bind(this))}else if(!b("RTCUtils").isSupportedMWCall(this.$MessengerRTCGroupCallIncomingDialogController1))b("MessengerParticipants.bs").get(b("MercuryIDs").getParticipantIDFromUserID(this.$MessengerRTCGroupCallIncomingDialogController3),function(a){return b("MessengerDialogs.bs").showDialog(function(){return b("React").createElement(b("MessengerRTCIncomingDialog.react"),{callID:this.$MessengerRTCGroupCallIncomingDialogController2.toString(),callerParticipant:a,isVideoCall:this.$MessengerRTCGroupCallIncomingDialogController5,onAccept:function(){return this.$MessengerRTCGroupCallIncomingDialogController11()}.bind(this),onDecline:function(){return this.$MessengerRTCGroupCallIncomingDialogController12()}.bind(this)})}.bind(this))}.bind(this));else{var c=[this.$MessengerRTCGroupCallIncomingDialogController3].concat(this.$MessengerRTCGroupCallIncomingDialogController4),d=b("RTWebClientFeatureGating").useNewIncomingCallDialog()?b("React").createElement(b("RTCGroupCallIncomingDialog.react"),{callID:this.$MessengerRTCGroupCallIncomingDialogController2.toString(),callerID:b("MercuryIDs").getParticipantIDFromUserID(this.$MessengerRTCGroupCallIncomingDialogController3),conferenceName:this.$MessengerRTCGroupCallIncomingDialogController1,isGroupCall:b("RTCUtils").isGroupCall(this.$MessengerRTCGroupCallIncomingDialogController1),hasVideo:this.$MessengerRTCGroupCallIncomingDialogController5,onAnswer:this.$MessengerRTCGroupCallIncomingDialogController11,onIgnore:function(){return this.$MessengerRTCGroupCallIncomingDialogController12()}.bind(this),participantIDs:c}):b("React").createElement(b("MessengerRTCGroupCallIncomingDialog.react"),{callID:this.$MessengerRTCGroupCallIncomingDialogController2.toString(),callerID:b("MercuryIDs").getParticipantIDFromUserID(this.$MessengerRTCGroupCallIncomingDialogController3),conferenceName:this.$MessengerRTCGroupCallIncomingDialogController1,isGroupCall:b("RTCUtils").isGroupCall(this.$MessengerRTCGroupCallIncomingDialogController1),hasVideo:this.$MessengerRTCGroupCallIncomingDialogController5,onAnswer:this.$MessengerRTCGroupCallIncomingDialogController11,onIgnore:function(){return this.$MessengerRTCGroupCallIncomingDialogController12()}.bind(this),participantIDs:c});b("MessengerDialogs.bs").showDialog(function(){return d})}this.$MessengerRTCGroupCallIncomingDialogController13(this.$MessengerRTCGroupCallIncomingDialogController5)};a.prototype.$MessengerRTCGroupCallIncomingDialogController13=function(a){a={callID:this.$MessengerRTCGroupCallIncomingDialogController2.toString(),peerID:this.$MessengerRTCGroupCallIncomingDialogController3,onNotificationClicked:this.$MessengerRTCGroupCallIncomingDialogController11.bind(this),isVideoCall:a,isGroupCall:b("RTCUtils").isGroupCall(this.$MessengerRTCGroupCallIncomingDialogController1)};b("MessengerBrowserAlerts").showRTCNotification(a,function(a){this.$MessengerRTCGroupCallIncomingDialogController8=a,this.$MessengerRTCGroupCallIncomingDialogController9&&this.$MessengerRTCGroupCallIncomingDialogController14()}.bind(this))};a.prototype.cancel=function(){this.$MessengerRTCGroupCallIncomingDialogController7&&b("clearTimeout")(this.$MessengerRTCGroupCallIncomingDialogController7),b("MessengerDialogs.bs").removeAllDialogs(),b("FBRTCSoundController").stopIncomingRingtone(),this.$MessengerRTCGroupCallIncomingDialogController8&&this.$MessengerRTCGroupCallIncomingDialogController14(),this.$MessengerRTCGroupCallIncomingDialogController9=!0};a.prototype.$MessengerRTCGroupCallIncomingDialogController12=function(){this.cancel(),this.emit("ignoreCall",!1)};a.prototype.$MessengerRTCGroupCallIncomingDialogController10=function(){this.cancel(),this.emit("timeout",!1)};a.prototype.$MessengerRTCGroupCallIncomingDialogController14=function(){this.$MessengerRTCGroupCallIncomingDialogController8&&(this.$MessengerRTCGroupCallIncomingDialogController8.close(),this.$MessengerRTCGroupCallIncomingDialogController8=null)};e.exports=a}),null);
__d("VFWebSupportUtils",["WebStorage","gkx"],(function(a,b,c,d,e,f){"use strict";__p&&__p();var g=b("WebStorage").getLocalStorage(),h={showAudioSettings:function(){return b("gkx")("678794")},showShareCallLink:function(){return b("gkx")("678795")},showIncomingCallDialogV2:function(){return b("gkx")("678796")},showP2PMissedCallDialogV2:function(){return b("gkx")("699260")},canAcceptCallWhileInCall:function(){return b("gkx")("691876")},canAccessDevTools:function(){return b("gkx")("698237")},isMiniViewSupported:function(){return b("gkx")("709734")},getUserSettings:function(){return g&&g.getItem?{audioInput:g.getItem("audioInput"),audioOutput:g.getItem("audioOutput"),videoInput:g.getItem("videoInput")}:{audioInput:null,audioOutput:null,videoInput:null}},saveUserSettings:function(a){g&&g.setItem&&(a.videoInput!=null&&g.setItem("videoInput",a.videoInput),a.audioInput!=null&&g.setItem("audioInput",a.audioInput),a.audioOutput!=null&&g.setItem("audioOutput",a.audioOutput))},isOldVersion:function(a){if(a===undefined||a===null)return!0;else if(a==="0.0.0")return!1;var b="0.0.201811061932";a=h._getAppVersionInt(a);b=h._getAppVersionInt(b);return a<b},_getAppVersionInt:function(a){a=a.split(".")[2].substring(0,8);return parseInt(a,10)}};e.exports=h}),null);
__d("VFWebAppState",["React","VFWebSupportUtils","immutable"],(function(a,b,c,d,e,f){"use strict";var g;g=babelHelpers.inherits(a,b("immutable").Record({showListTray:!0,showAddPeopleTray:!1,miniViewActive:!1,audioSettings:b("immutable").Map(),callGridLayout:{fullScreenUserID:null},overlayModal:null,userSettings:b("VFWebSupportUtils").getUserSettings(),joiningConference:!1,linkUrl:null,locallyMutedUsers:b("immutable").Set(),protocolHandler:null,promotionData:null,isNetworkConnected:!0,failedCallData:null}));g&&g.prototype;function a(){g.apply(this,arguments)}e.exports=a}),null);
__d("VFWebLogger",["VFDesktopHelper","VFWebUserActionsTypedLogger","WebFunnelLogger","immutable"],(function(a,b,c,d,e,f){"use strict";__p&&__p();var g=b("immutable").Map;function a(){this.$1=g()}a.prototype.logCheckpoint=function(a,b,event){this.logEvent(babelHelpers["extends"]({},Object.assign({},event),{event:"checkpoint",surface:a,checkpoint:b}))};a.prototype.logClick=function(a,b,event){this.logEvent(babelHelpers["extends"]({},Object.assign({},event),{event:"click",surface:a,component:b}))};a.prototype.logError=function(a,b,c,event){this.logEvent(babelHelpers["extends"]({},Object.assign({},event),{event:"error",surface:a,error_domain:b,error_details:c}))};a.prototype.logEvent=function(event){var a=b("VFDesktopHelper").getSessionID(),c=babelHelpers["extends"]({},event,{client_time:Math.floor(Date.now()/1e3),device_id:b("VFDesktopHelper").getDeviceID(),session_id:a}),d=this.$2(c);d!=null&&new(b("WebFunnelLogger"))("VFWebAppFunnelDefinition").setAction(d).setSessionKey(a).log();new(b("VFWebUserActionsTypedLogger"))().updateData(c).log()};a.prototype.startTimer=function(a){this.$1=this.$1.set(a,Date.now())};a.prototype.stopTimer=function(a){var b=this.$1.get(a);if(b){this.$1=this.$1.remove(a);return Date.now()-b}return null};a.prototype.$2=function(event){switch(event.event){case"checkpoint":return event.checkpoint;case"click":return event.component;case"error":return event.error_domain;case"impression":default:return null}};e.exports=new a()}),null);
__d("VFWebCallLogger",["FBRTCParticipantCallState","RTCAppDispatcher","RTCCallActionTypes","RTCCallStore","VFWebLogger","immutable"],(function(a,b,c,d,e,f){"use strict";__p&&__p();var g=b("immutable").List,h=b("immutable").Map,i=h();function a(a,c){b("RTCAppDispatcher").waitFor([b("RTCCallStore").getDispatchToken()]);s.logRTCCallAction(b("RTCCallStore").getState(),c);return a}function c(a,c){__p&&__p();var d=a.callInfo.conferenceName;if(d){var e=k(a.callInfo.conferenceName),f=c.type;switch(f){case b("RTCCallActionTypes").CALL:o(a,c,d,e);break;case b("RTCCallActionTypes").CALL_ERROR:p(a,c,d,e);break;case b("RTCCallActionTypes").ON_CONFERENCE_STATE:q(a,c,d,e);break;case b("RTCCallActionTypes").DISMISS:case b("RTCCallActionTypes").HANGUP:case b("RTCCallActionTypes").END_CALL:r(a,c,d,e)}}}function d(a,b){a=k(a);a.expectedParticipantCount=b}function f(){i=i.clear()}function j(a,b){b===void 0&&(b=0);b={expectedParticipantCount:b,callState:"init",lastStateChange:Date.now()};i=i.set(a,b);return b}function k(a){return i.has(a)?i.get(a):j(a)}function l(a,b){b!==a.callState&&(m(a.callState,b,a),a.lastStateChange=Date.now()),a.callState=b}function m(a,b,c){switch(a){case"init":}}function n(a){if(!a)return g();a=h(a.participantStates||{}).filter(function(a){return a.state===b("FBRTCParticipantCallState").CONNECTED});return g(a.keys())}function o(a,c,d,e){l(e,"connecting"),b("VFWebLogger").startTimer("vfweb_timer_call_join"),b("VFWebLogger").logCheckpoint(null,"vfweb_call_join_start",{conference_name:d,expected_participant_count:e.expectedParticipantCount}),i=i.withMutations(function(a){a.forEach(function(c,d){c!==e&&(a.remove(d),c.callState!=="terminated"&&b("VFWebLogger").logError(null,"VFWebCallLogger","UnterminatedCall",{conference_name:d}))})})}function p(a,c,d,e){l(e,"terminated"),b("VFWebLogger").logError(null,"VFWebJoinCallError",c.endCallReason+": "+c.endCallSubreason,{conference_name:d,duration:b("VFWebLogger").stopTimer("vfweb_timer_call_join"),expected_participant_count:e.expectedParticipantCount})}function q(a,c,d,e){a=n(c.request.conferenceStateRequest());c=a.size;e.callState==="connecting"&&b("VFWebLogger").logCheckpoint(null,"vfweb_call_join_success",{conference_name:d,duration:b("VFWebLogger").stopTimer("vfweb_timer_call_join"),participant_count:c,expected_participant_count:e.expectedParticipantCount});c>1&&e.callState!=="partying"?(b("VFWebLogger").startTimer("vfweb_timer_call_party"),b("VFWebLogger").logCheckpoint(null,"vfweb_party_start",{conference_name:d,participant_count:c})):c<2&&e.callState==="partying"&&b("VFWebLogger").logCheckpoint(null,"vfweb_party_end",{duration:b("VFWebLogger").stopTimer("vfweb_timer_call_party"),conference_name:d});l(e,c>1?"partying":"connected")}function r(a,c,d,e){e.callState==="partying"?b("VFWebLogger").logCheckpoint(null,"vfweb_party_end",{duration:b("VFWebLogger").stopTimer("vfweb_timer_call_party"),conference_name:d}):e.callState==="connecting"?b("VFWebLogger").logCheckpoint(null,"vfweb_call_join_cancel",{duration:b("VFWebLogger").stopTimer("vfweb_timer_call_join"),conference_name:d,expected_participant_count:e.expectedParticipantCount}):c.type===b("RTCCallActionTypes").DISMISS&&b("VFWebLogger").logCheckpoint(null,"vfweb_call_join_remote_cancel",{duration:b("VFWebLogger").stopTimer("vfweb_timer_call_join"),conference_name:d,expected_participant_count:e.expectedParticipantCount}),l(e,"terminated")}var s={reduce:a,logRTCCallAction:c,setExpectedParticipantCount:d,clearCallLogs:f};e.exports=s}),null);
__d("VFWebAppFluxStore",["FluxReduceStore","React","RTCAppDispatcher","RTCCallActionTypes","VFWebAppState","VFWebAppStateReducer","VFWebCallLogger","VFWebSupportUtils","immutable"],(function(a,b,c,d,e,f){"use strict";__p&&__p();var g,h=[b("VFWebAppStateReducer").reduce,b("VFWebCallLogger").reduce];g=babelHelpers.inherits(a,b("FluxReduceStore"));g&&g.prototype;a.prototype.getInitialState=function(){return new(b("VFWebAppState"))()};a.prototype.reduce=function(a,b){return h.reduce(function(a,c){return c(a,b)},a)};a.prototype.toggleFullScreenUser=function(a){b("RTCAppDispatcher").dispatch({type:"toggle_full_screen_user",user:a})};a.prototype.closeListTray=function(){b("RTCAppDispatcher").dispatch({type:"close_list_tray"})};a.prototype.openListTray=function(){b("RTCAppDispatcher").dispatch({type:"open_list_tray"})};a.prototype.setJoiningConference=function(a){b("RTCAppDispatcher").dispatch({type:"joining_conference",joiningConference:a})};a.prototype.setLinkUrl=function(a){b("RTCAppDispatcher").dispatch({type:"link_url",linkUrl:a})};a.prototype.toggleListTray=function(){b("RTCAppDispatcher").dispatch({type:"toggle_list_tray"})};a.prototype.toggleAddPeopleTray=function(){b("RTCAppDispatcher").dispatch({type:"toggle_add_people_tray"})};a.prototype.closeAddPeopleTray=function(){b("RTCAppDispatcher").dispatch({type:"close_add_people_tray"})};a.prototype.openAddPeopleTray=function(){b("RTCAppDispatcher").dispatch({type:"open_add_people_tray"})};a.prototype.setMiniViewStatus=function(a){b("RTCAppDispatcher").dispatch({type:"set_mini_view_status",isActive:a})};a.prototype.addNotification=function(a,c){b("RTCAppDispatcher").dispatch({type:"add_notification",key:a,notificationHTML:c})};a.prototype.removeNotification=function(a){b("RTCAppDispatcher").dispatch({type:"remove_notification",key:a})};a.prototype.saveAudioSettings=function(a){b("RTCAppDispatcher").dispatch({type:"save_audio_settings",audioSettings:a})};a.prototype.addOverlayModal=function(a){b("RTCAppDispatcher").dispatch({type:"add_overlay_modal",modal:a})};a.prototype.removeOverlayModal=function(){b("RTCAppDispatcher").dispatch({type:"remove_overlay_modal"})};a.prototype.autoMuteVideo=function(){b("RTCAppDispatcher").dispatch({type:b("RTCCallActionTypes").VIDEO_MUTED,autoBackgroundMuting:!0})};a.prototype.changeUserSettings=function(a){b("VFWebSupportUtils").saveUserSettings(a),b("RTCAppDispatcher").dispatch({type:"CHANGE_USER_SETTINGS",settings:a})};a.prototype.joinedCall=function(a){b("RTCAppDispatcher").dispatch({type:"JOINED_CALL",protocolHandler:a})};a.prototype.leftCall=function(){b("RTCAppDispatcher").dispatch({type:"LEFT_CALL"})};a.prototype.startCallingUsers=function(a){b("RTCAppDispatcher").dispatch({type:"STARTED_CALLING_USERS",users:a})};a.prototype.setPromotionData=function(a){b("RTCAppDispatcher").dispatch({type:"SET_PROMOTION_DATA",promotionData:a})};a.prototype.toggleMuteRemoteAudio=function(a,c){b("RTCAppDispatcher").dispatch({type:a?"locally_mute_remote_audio":"locally_unmute_remote_audio",userID:c})};a.prototype.setNetworkConnectionStatus=function(a){b("RTCAppDispatcher").dispatch({type:"set_network_connection_status",isNetworkConnected:a})};a.prototype.setFailedCallData=function(a){b("RTCAppDispatcher").dispatch({type:"set_failed_call_data",failedCallData:a})};a.prototype.updateVideoInputDevices=function(a){b("RTCAppDispatcher").dispatch({type:"update_media_devices",newVideoInput:a})};function a(){g.apply(this,arguments)}a.__moduleID=e.id;e.exports=new a(b("RTCAppDispatcher"))}),null);
__d("VFWebAppStateReducer",["CurrentUser","FBRTCConstants","React","RTCCallActionTypes","VFWebCallErrorModal.react","immutable"],(function(a,b,c,d,e,f){"use strict";__p&&__p();var g=b("FBRTCConstants").CallEndReason;function a(a,c){__p&&__p();switch(c.type){case b("RTCCallActionTypes").CALL_ERROR:return i(a,c);case"toggle_list_tray":return a.showListTray?a.set("showListTray",!1):a.set("showListTray",!0).set("showAddPeopleTray",!1);case"close_list_tray":return a.set("showListTray",!1);case"open_list_tray":return j(a);case"toggle_add_people_tray":return a.showAddPeopleTray?a.set("showAddPeopleTray",!1):a.set("showAddPeopleTray",!0).set("showListTray",!1);case"open_add_people_tray":return a.set("showAddPeopleTray",!0).set("showListTray",!1);case"close_add_people_tray":return a.set("showAddPeopleTray",!1);case"set_mini_view_status":return a.set("miniViewActive",c.isActive);case"save_audio_settings":return a.set("audioSettings",c.audioSettings);case"add_overlay_modal":return a.set("overlayModal",c.modal);case"remove_overlay_modal":return a.set("overlayModal",null);case"joining_conference":return a.set("joiningConference",c.joiningConference);case"link_url":return a.set("linkUrl",c.linkUrl);case"CHANGE_USER_SETTINGS":return a.set("userSettings",c.settings);case"JOINED_CALL":return a.set("protocolHandler",c.protocolHandler).set("showListTray",!1).set("showAddPeopleTray",!0).set("failedCallData",null);case"STARTED_CALLING_USERS":return a.set("showListTray",!1).set("showAddPeopleTray",!0);case"LEFT_CALL":return j(a).set("protocolHandler",null).set("locallyMutedUsers",b("immutable").Set()).set("callGridLayout",{fullScreenUserID:null});case"SET_PROMOTION_DATA":return a.set("promotionData",c.promotionData);case"set_failed_call_data":return a.set("failedCallData",c.failedCallData);case"toggle_full_screen_user":var d=c.user.FBID===a.callGridLayout.fullScreenUserID?null:c.user;return h(a,d);case"VIDEO_MUTED":d=b("CurrentUser").getID()===a.callGridLayout.fullScreenUserID;return d?h(a,null):a;case"locally_mute_remote_audio":return a.set("locallyMutedUsers",a.locallyMutedUsers.add(c.userID));case"locally_unmute_remote_audio":return a.set("locallyMutedUsers",a.locallyMutedUsers["delete"](c.userID));case"set_network_connection_status":return a.set("isNetworkConnected",c.isNetworkConnected);default:return a;case"update_media_devices":d=a.userSettings;return a.set("userSettings",babelHelpers["extends"]({},d,{videoInput:c.newVideoInput}))}}function h(a,b){if(b===null)return a.set("callGridLayout",{fullScreenUserID:null});var c=!!b&&!b.isVideoMuted();return c?a.set("callGridLayout",{fullScreenUserID:b==null?void 0:b.FBID}):a}function i(a,c){return c.endCallReason!==g.HANGUP_CALL?a.set("overlayModal",b("React").createElement(b("VFWebCallErrorModal.react"),null)):a}function j(a){return a.set("showListTray",!0).set("showAddPeopleTray",!1)}e.exports={reduce:a}}),null);
__d("VFWebStrings",["fbt","FBRTCParticipantCallState","React","Timestamp.react"],(function(a,b,c,d,e,f,g){"use strict";__p&&__p();e.exports={app_name:g._("Messenger Video Chat"),ring_friend_button:g._("Ring"),invite_friend_button:g._("Invite"),cancel_ring_button:g._("Cancel"),preview_camera_microphone:g._("Preview On"),disable_camera_microphone:g._("Preview Off"),join_video_chat_link:g._("Join Video Chat"),redial_remote_user:g._("Re-dial Remote User"),dont_join_video_chat_link:g._("Not now"),blocked_user:g._("Blocked"),welcome_screen_message:g._("Start Video Chatting"),welcome_screen_call_to_action:g._("Search for someone by name to start a call"),call_history_recent_header_label:g._("Recent"),toggle_tray:g._("Toggle tray"),leaveCall:g._("Leave call"),toggleScreenShare:g._("Toggle screen sharing"),toggleMute:g._("Toggle mute"),toggleVideo:g._("Toggle video"),close_window_warning:g._("Leaving so soon?"),ignore_button_label:g._("Ignore"),label_refresh:g._("Refresh"),load_error_media:g._("An Error occured when trying to get access to Camera and\/or Microphone:"),load_error_media_permission:g._("Please Allow Camera and Microphone Access"),load_error_media_permission_explanation:g._("To use VFWeb, you need to turn your camera and microphone on. This will let your friends see and hear you when you connect with them."),load_error_media_permission_explanation_later:g._("You can turn these off later."),load_error_media_permission_learn_more:g._("Learn more"),load_error_unknown:g._("An Unknown Error occured trying to load VFWeb."),load_error_unknown_refresh_request:g._("Please refresh your browser or try again later."),activeOnline:g._("Active now"),logout:g._("Log Out"),settings:g._("Settings"),audio_settings:g._("Audio Settings"),audio_settings_modal_title:g._("Audio Settings"),search_placeholder:g._("Search for your friends and groups"),hideListTray:g._("Hide"),ignore:g._("Ignore"),join_button_label:g._("Join Call"),joining_generic_error_title:g._("Could Not Join Call"),joining_generic_error_message:g._("Something happened and we could not join this call. Please try again."),okay:g._("Okay"),noAnswerOnOutgoingCall:g._("No Answer"),user_video_off:function(a){return g._("{name}'s camera is off",[g._param("name",a)])},video_escalation:g._("Requesting video..."),viewer_video_off:function(a){return g._("Your camera is off")},call_state:function(a){__p&&__p();switch(a){case b("FBRTCParticipantCallState").DISCONNECTED:return g._("Disconnected");case b("FBRTCParticipantCallState").NO_ANSWER:case b("FBRTCParticipantCallState").IN_ANOTHER_CALL:case b("FBRTCParticipantCallState").REJECTED:return g._("No Answer");case b("FBRTCParticipantCallState").UNREACHABLE:return g._("Unreachable");case b("FBRTCParticipantCallState").CONNECTION_DROPPED:return g._("Connection dropped");case b("FBRTCParticipantCallState").CONTACTING:return g._("Contacting...");case b("FBRTCParticipantCallState").RINGING:return g._("Ringing...");case b("FBRTCParticipantCallState").CONNECTING:return g._("Connecting...");case b("FBRTCParticipantCallState").CONNECTED:return g._("Connected");case b("FBRTCParticipantCallState").PARTICIPANT_LIMIT_REACHED:return g._("Participant limit reached");case b("FBRTCParticipantCallState").RING_TYPE_UNSUPPORTED:return g._("Not supported");default:return null}},full_label:g._("Full"),call_created_time:function(a){return g._("{relative time, like '2 hours'} ago",[g._param("relative time, like '2 hours'",b("React").createElement(b("Timestamp.react"),{minimize:!0,shorten:!0,time:a,useLargerTimeUnits:!0}))])},in_this_call_label:g._("In this call"),yourself_in_call_row:g._("You"),oops_message:g._("Oops! It looks like something went wrong."),oops_sub_message:g._("You can help us fix this by using the Bug Nub below. Then restart to try again. Thanks!"),restart:g._("Restart"),no_internet_connection:g._("No internet connection"),dismiss_failed_call:g._("Dismiss"),redial:g._("Redial"),call_roster_ongoing_video_chat:g._("Ongoing Video Chat"),ringing:g._("Ringing"),update_old_build_prompt:g._("Oops! You're on an old build. Please go {=fburl.com\/dvc} to manually update. New builds will auto-update.",[g._param("=fburl.com/dvc",b("React").createElement("b",null,g._("fburl.com\/dvc")))]),no_camera_message_title:g._("No camera found."),no_camera_message_action:g._("Check audio and video settings")}}),null);
__d("VFWebCallErrorModal.react",["cx","React","VFWebAppFluxStore","VFWebStrings","XUIButton.react"],(function(a,b,c,d,e,f,g){"use strict";__p&&__p();var h;h=babelHelpers.inherits(a,b("React").Component);h&&h.prototype;a.prototype.render=function(){return b("React").createElement("div",{className:"_3z8p"},b("React").createElement("div",{className:"_2mg3 _3z8t"},b("VFWebStrings").joining_generic_error_title),b("React").createElement("div",{className:"_2mg7 _3z8s"},b("VFWebStrings").joining_generic_error_message),b("React").createElement("div",{className:"_3zev"},b("React").createElement(b("XUIButton.react"),{className:"_2uct _3zey _2lvh",label:b("VFWebStrings").okay,onClick:this.$1,size:"small"})))};a.prototype.$1=function(){b("VFWebAppFluxStore").removeOverlayModal()};function a(){h.apply(this,arguments)}e.exports=a}),null);
__d("VFWebIncomingCallDialogUtils",["regeneratorRuntime","RelayFBEnvironment","RelayModern","VFWebIncomingCallDialogUtils_userQuery.graphql"],(function(a,b,c,d,e,f){__p&&__p();var g=b("RelayModern").fetchQuery;b("RelayModern").graphql;var h=function(){return b("VFWebIncomingCallDialogUtils_userQuery.graphql")};function a(a,c,d,e){__p&&__p();var f;return b("regeneratorRuntime").async(function(j){__p&&__p();while(1)switch(j.prev=j.next){case 0:return j.abrupt("return",g(b("RelayFBEnvironment"),h,{user_ids:c?[a].concat(c):[a],thread_id:(f=d)!=null?f:0,should_fetch_thread:!!d,picture_width:e.width,picture_height:e.height}).then(function(b){var c=b.message_thread;c=c?{name:c.thread_name,imageUri:(c=c.image)==null?void 0:c.uri}:null;b=b.nodes;var d=b.find(function(b){return b.id===a});b=b.filter(function(b){return b.id!==a});d=[d].concat(b).map(i);return{participants:d,messageThread:c}}));case 1:case"end":return j.stop()}},null,this)}function i(a){return{shortName:a.short_name,profilePictureUri:a.profile_picture.uri,name:a.name}}e.exports={fetchIncomingCallData:a}}),null);
__d("VFWebMissedCallDialogController",["regeneratorRuntime","VFDesktopHelper","VFWebCallUtils","VFWebIncomingCallDialogUtils","promiseDone"],(function(a,b,c,d,e,f){"use strict";__p&&__p();function a(){this.$1=null}a.prototype.onCallMissed=function(a){this.$1=a};a.prototype.showDialog=function(){if(this.$1==null)return;b("promiseDone")(this.$2(this.$1))};a.prototype.$2=function(a){__p&&__p();var c,d,e,f;return b("regeneratorRuntime").async(function(g){__p&&__p();while(1)switch(g.prev=g.next){case 0:g.next=2;return b("regeneratorRuntime").awrap(b("VFWebIncomingCallDialogUtils").fetchIncomingCallData(a,null,null,{width:120,height:120}));case 2:c=g.sent;d=c.participants;g.next=6;return b("regeneratorRuntime").awrap(b("VFDesktopHelper").showMissedCallDialog(d[0]));case 6:e=g.sent;f=e.response;g.t0=f;g.next=g.t0==="call-back"?11:g.t0==="close"?14:16;break;case 11:this.hideDialog();b("VFWebCallUtils").placeOutgoingCall([a]);return g.abrupt("break",17);case 14:this.hideDialog();return g.abrupt("break",17);case 16:return g.abrupt("break",17);case 17:case"end":return g.stop()}},null,this)};a.prototype.hideDialog=function(){b("VFDesktopHelper").dismissMissedCallDialog()};e.exports=a}),null);
__d("VFWebConferenceNameUtils",[],(function(a,b,c,d,e,f){"use strict";__p&&__p();var g="PEER",h="GROUP";function i(a,b){return a+":"+b}function j(a,b){return b==null?null:b.startsWith(a+":")?b.substr(a.length+1):null}function a(a){return j(g,a)}function b(a){return i(g,a)}function c(a){return j(h,a)}function d(a){return i(h,a)}e.exports={buildP2PConferenceName:b,buildGroupConferenceName:d,parseGroupConferenceName:c,parseP2PConferenceName:a}}),null);
__d("VFWebCallStore",["FluxReduceStore","RTCAppDispatcher","immutable"],(function(a,b,c,d,e,f){"use strict";__p&&__p();var g,h;g=babelHelpers.inherits(i,b("immutable").Record({incomingCallConferenceName:null}));g&&g.prototype;function i(){g.apply(this,arguments)}h=babelHelpers.inherits(a,b("FluxReduceStore"));h&&h.prototype;a.prototype.getInitialState=function(){return new i()};a.prototype.reduce=function(a,b){switch(b.type){case"handle_incoming_call":return a.set("incomingCallConferenceName",b.conferenceName);case"resolve_incoming_call":return a.set("incomingCallConferenceName",null);default:return a}};a.prototype.isHandlingIncomingCall=function(){return this.getState().incomingCallConferenceName!==null};a.prototype.handleIncomingCall=function(a){b("RTCAppDispatcher").dispatch({type:"handle_incoming_call",conferenceName:a})};a.prototype.resolveIncomingCall=function(){b("RTCAppDispatcher").dispatch({type:"resolve_incoming_call"})};function a(){h.apply(this,arguments)}a.__moduleID=e.id;e.exports=new a(b("RTCAppDispatcher"))}),null);
__d("VFWebGroupCallIncomingDialogController",["regeneratorRuntime","EventEmitter","FBRTCHangupReason","FBRTCSoundController","RTCCallStore","RTCUtils","VFDesktopHelper","VFWebCallStore","VFWebIncomingCallDialogUtils","clearTimeout","promiseDone","setTimeoutAcrossTransitions"],(function(a,b,c,d,e,f){"use strict";__p&&__p();var g,h=7e4;c=babelHelpers.inherits(a,b("EventEmitter"));g=c&&c.prototype;function a(a,c,d,e,f,h){g.constructor.call(this),this.$VFWebGroupCallIncomingDialogController8=function(){this.$VFWebGroupCallIncomingDialogController12(),this.emit("timeout",b("RTCCallStore").getState().callInfo.isInCall())}.bind(this),this.$VFWebGroupCallIncomingDialogController1=a,this.$VFWebGroupCallIncomingDialogController2=c,this.$VFWebGroupCallIncomingDialogController3=d,this.$VFWebGroupCallIncomingDialogController4=e,this.$VFWebGroupCallIncomingDialogController5=f,this.$VFWebGroupCallIncomingDialogController6=h,this.$VFWebGroupCallIncomingDialogController7=null}a.prototype.serverInfoData=function(){return this.$VFWebGroupCallIncomingDialogController6};a.getHangUpReasonForNewRequest=function(){return b("VFWebCallStore").isHandlingIncomingCall()?b("FBRTCHangupReason").IN_ANOTHER_CALL:null};a.prototype.showIncomingDialog=function(){this.$VFWebGroupCallIncomingDialogController7=b("setTimeoutAcrossTransitions")(this.$VFWebGroupCallIncomingDialogController8,h),b("FBRTCSoundController").playIncomingRingtone(this.$VFWebGroupCallIncomingDialogController2,this.$VFWebGroupCallIncomingDialogController1,{loop:!0,isP2P:!1}),b("VFWebCallStore").handleIncomingCall(this.$VFWebGroupCallIncomingDialogController1),b("promiseDone")(this.$VFWebGroupCallIncomingDialogController9())};a.prototype.$VFWebGroupCallIncomingDialogController9=function(){__p&&__p();var a,c,d,e,f,g,h;return b("regeneratorRuntime").async(function(i){__p&&__p();while(1)switch(i.prev=i.next){case 0:a=b("RTCUtils").getThreadID(this.$VFWebGroupCallIncomingDialogController1);i.next=3;return b("regeneratorRuntime").awrap(b("VFWebIncomingCallDialogUtils").fetchIncomingCallData(this.$VFWebGroupCallIncomingDialogController3,this.$VFWebGroupCallIncomingDialogController4,a,{width:60,height:60}));case 3:c=i.sent;d=c.participants;e=c.messageThread;i.next=8;return b("regeneratorRuntime").awrap(b("VFDesktopHelper").showIncomingCallDialog(d,this.$VFWebGroupCallIncomingDialogController5,e,!1));case 8:f=i.sent;g=f.response;h=f.initializeVideo;i.t0=g;i.next=i.t0==="accept"?14:i.t0==="ignore"?16:18;break;case 14:this.$VFWebGroupCallIncomingDialogController10(Boolean(h));return i.abrupt("break",19);case 16:this.$VFWebGroupCallIncomingDialogController11();return i.abrupt("break",19);case 18:throw new Error("Received unrecognized response "+g);case 19:case"end":return i.stop()}},null,this)};a.prototype.cancel=function(){this.$VFWebGroupCallIncomingDialogController12(),b("VFWebCallStore").resolveIncomingCall()};a.prototype.$VFWebGroupCallIncomingDialogController12=function(){this.$VFWebGroupCallIncomingDialogController7&&(b("clearTimeout")(this.$VFWebGroupCallIncomingDialogController7),this.$VFWebGroupCallIncomingDialogController7=null),b("FBRTCSoundController").stopIncomingRingtone(),b("VFDesktopHelper").dismissIncomingCallDialog()};a.prototype.$VFWebGroupCallIncomingDialogController10=function(a){this.$VFWebGroupCallIncomingDialogController12(),this.emit("answerCall",this.$VFWebGroupCallIncomingDialogController1,a)};a.prototype.$VFWebGroupCallIncomingDialogController11=function(){this.$VFWebGroupCallIncomingDialogController12(),this.emit("ignoreCall",b("RTCCallStore").getState().callInfo.isInCall())};e.exports=a}),null);
__d("VFWebP2PCallIncomingDialogController",["regeneratorRuntime","CurrentUser","EventEmitter","FBRTCConstants","FBRTCSoundController","VFDesktopHelper","VFWebCallStore","VFWebConferenceNameUtils","VFWebIncomingCallDialogUtils","clearTimeout","promiseDone","setTimeoutAcrossTransitions"],(function(a,b,c,d,e,f){"use strict";__p&&__p();var g,h=7e4;c=babelHelpers.inherits(a,b("EventEmitter"));g=c&&c.prototype;function a(a,b){g.constructor.call(this),this.$VFWebP2PCallIncomingDialogController4=function(){this.$VFWebP2PCallIncomingDialogController8(),this.emit("timeout",!1)}.bind(this),this.$VFWebP2PCallIncomingDialogController1=a,this.$VFWebP2PCallIncomingDialogController2=b,this.$VFWebP2PCallIncomingDialogController3=null}a.getCallEndReasonForNewRequest=function(){return b("VFWebCallStore").isHandlingIncomingCall()?b("FBRTCConstants").CallEndReason.IN_ANOTHER_CALL:null};a.prototype.showIncomingDialog=function(a){this.$VFWebP2PCallIncomingDialogController3=b("setTimeoutAcrossTransitions")(this.$VFWebP2PCallIncomingDialogController4,h),b("FBRTCSoundController").playIncomingRingtone(this.$VFWebP2PCallIncomingDialogController2,this.$VFWebP2PCallIncomingDialogController1,{loop:!0,isP2P:!0}),b("VFWebCallStore").handleIncomingCall(b("VFWebConferenceNameUtils").buildP2PConferenceName(this.$VFWebP2PCallIncomingDialogController1)),b("promiseDone")(this.$VFWebP2PCallIncomingDialogController5(a))};a.prototype.$VFWebP2PCallIncomingDialogController5=function(a){__p&&__p();var c,d,e,f,g,h;return b("regeneratorRuntime").async(function(i){__p&&__p();while(1)switch(i.prev=i.next){case 0:c=a===b("FBRTCConstants").IncomingCallDialogTypes.VIDEO;i.next=3;return b("regeneratorRuntime").awrap(b("VFWebIncomingCallDialogUtils").fetchIncomingCallData(this.$VFWebP2PCallIncomingDialogController1,[b("CurrentUser").getAccountID()],null,{width:120,height:120}));case 3:d=i.sent;e=d.participants;i.next=7;return b("regeneratorRuntime").awrap(b("VFDesktopHelper").showIncomingCallDialog(e,c,null,!0));case 7:f=i.sent;g=f.response;h=f.initializeVideo;i.t0=g;i.next=i.t0==="accept"?13:i.t0==="ignore"?15:17;break;case 13:this.$VFWebP2PCallIncomingDialogController6(Boolean(h));return i.abrupt("break",18);case 15:this.$VFWebP2PCallIncomingDialogController7();return i.abrupt("break",18);case 17:throw new Error("Received unrecognized response "+g);case 18:case"end":return i.stop()}},null,this)};a.prototype.cancel=function(){this.$VFWebP2PCallIncomingDialogController8(),b("VFWebCallStore").resolveIncomingCall()};a.prototype.$VFWebP2PCallIncomingDialogController8=function(){this.$VFWebP2PCallIncomingDialogController3&&b("clearTimeout")(this.$VFWebP2PCallIncomingDialogController3),b("FBRTCSoundController").stopIncomingRingtone(),b("VFDesktopHelper").dismissIncomingCallDialog()};a.prototype.$VFWebP2PCallIncomingDialogController6=function(a){this.$VFWebP2PCallIncomingDialogController8(),this.emit("answerCall",this.$VFWebP2PCallIncomingDialogController2.toString(),a)};a.prototype.$VFWebP2PCallIncomingDialogController7=function(){this.$VFWebP2PCallIncomingDialogController8(),this.emit("ignoreCall",!1)};a.prototype.isForPeer=function(a){return this.$VFWebP2PCallIncomingDialogController1===a};a.prototype.isForCall=function(a){return this.$VFWebP2PCallIncomingDialogController2===a};a.prototype.isForPeerAndCall=function(a,b){return this.$VFWebP2PCallIncomingDialogController1===a&&this.$VFWebP2PCallIncomingDialogController2===b};e.exports=a}),null);
__d("VFWebRingListener",["invariant","FBRTCConstants","FBRTCGroupCallIncomingController","FBRTCIncomingCallController","FBRTCMessageListener","FBRTCUnsupportedBrowserMessage","MessengerRTCGroupCallIncomingDialogController","MessengerRTCIncomingDialogController","MessengerRTCMissedCallDialogController","RTCCallStore","VFWebCallUtils","VFWebConferenceNameUtils","VFWebGroupCallIncomingDialogController","VFWebMissedCallDialogController","VFWebP2PCallIncomingDialogController","VFWebSupportUtils"],(function(a,b,c,d,e,f,g){"use strict";__p&&__p();var h=b("FBRTCConstants").SignalingProtocol,i=null,j=null,k={init:function(){__p&&__p();if(i)return;b("FBRTCMessageListener").init(!1);var a=b("MessengerRTCGroupCallIncomingDialogController"),c=b("MessengerRTCIncomingDialogController");b("VFWebSupportUtils").showIncomingCallDialogV2()&&(a=b("VFWebGroupCallIncomingDialogController"),c=b("VFWebP2PCallIncomingDialogController"));var d=b("VFWebSupportUtils").showP2PMissedCallDialogV2()?new(b("VFWebMissedCallDialogController"))():b("MessengerRTCMissedCallDialogController");i=new(b("FBRTCGroupCallIncomingController"))(a,!1);i.setCustomAnswerHandler(function(a){var c=b("RTCCallStore").getState().localUser.FBID;a.callSummary.onCallStarted("answer button");b("VFWebCallUtils").answerIncomingCall({initializeVideo:a.initializeVideo,callID:a.callID.toString(),conferenceName:a.conferenceName,serverInfoData:a.serverInfoData,signalingProtocol:h.MULTIWAY,endCurrentCall:b("VFWebSupportUtils").canAcceptCallWhileInCall(),remoteUserFBIDs:a.participantFBIDs.filter(function(a){return a!==c})})});b("FBRTCMessageListener").setMultiwayMessageHandler(i.onMessageReceived.bind(i));b("FBRTCMessageListener").setBonfireMessageHandler(i.onBonfireMessageReceived.bind(i));j=new(b("FBRTCIncomingCallController"))(c,b("FBRTCUnsupportedBrowserMessage"),d);j.setCustomAnswerHandler(function(a){b("FBRTCMessageListener").removeMessageHandler(),b("VFWebCallUtils").answerIncomingCall({initializeVideo:a.initializeVideo,conferenceName:b("VFWebConferenceNameUtils").buildP2PConferenceName(a.peerID),callID:a==null?void 0:a.callID,signalingProtocol:h.P2P,endCurrentCall:b("VFWebSupportUtils").canAcceptCallWhileInCall()})});k.listenP2P()},listenP2P:function(){j||g(0,1836),b("FBRTCMessageListener").removeMessageHandler(),b("FBRTCMessageListener").setMessageHandler(function(a){j&&j.onMessageReceived(a)})}};e.exports=k}),null);
__d("VFWebEndCallMutation",["Promise","FBRTCConstants","FBRTCHangupReason","RTCCallActions","RTCCallStore","RTCP2PCallStore","RTCConferenceState","RTCMWProtocolHandler","VFWebRingListener","nullthrows"],(function(a,b,c,d,e,f){"use strict";__p&&__p();var g=b("FBRTCConstants").SignalingProtocol;function h(){var a=b("RTCP2PCallStore").getState().protocolHandler;a&&a.endCall();b("VFWebRingListener").listenP2P();return b("Promise").resolve()}function i(a,c){return b("RTCMWProtocolHandler").genEndCall(b("nullthrows")(a),b("FBRTCHangupReason").HANGUP_CALL,{serverInfoData:c,keepLocalStream:!0})}function a(){var a=b("RTCCallStore").getState(),c=a.callInfo,d=a.localUser;a=c.conferenceState===b("RTCConferenceState").CONNECTED||c.conferenceState===b("RTCConferenceState").CONNECTING;var e=Boolean(c.protocol===g.P2P&&b("RTCP2PCallStore").getState().protocolHandler);return(a?e?h():i(c.conferenceName,c.serverInfoData):b("Promise").resolve()).then(function(){b("RTCCallActions").reset(),b("RTCCallActions").initLocalUser(d)})["catch"](function(a){})}e.exports=a}),null);
__d("FluxTrigger",["invariant"],(function(a,b,c,d,e,f,g){"use strict";__p&&__p();h.create=function(a,b,c){return new h(a,b,c)};function h(a,b,c){this.$6=null,this.$7=function(a){this.$1.waitFor(this.$3);a=this.$4();this.$5(this.$6,a);this.$6=a}.bind(this),this.$4=b,this.$5=c,this.$1=i(a),this.$3=a.map(function(a){return a.getDispatchToken()})}h.prototype.getDispatchToken=function(){return this.$2};h.prototype.attach=function(){this.$2||(this.$2=this.$1.register(this.$7),this.$1.explicitlyRegisterStore&&this.$1.explicitlyRegisterStore(this))};h.prototype.release=function(){this.$2&&this.$1.unregister(this.$2)};function i(a){a&&a.length||g(0,5119);a=a[0].getDispatcher();return a}e.exports=h}),null);
__d("VFWebCreateCallMutation",["Promise","FBRTCConstants","RelayFBEnvironment","RelayModern","RTCCallActions","VFWebCreateCallMutation.graphql"],(function(a,b,c,d,e,f){"use strict";__p&&__p();var g=b("RelayModern").commitMutation;b("RelayModern").graphql;var h=b("FBRTCConstants").SignalingProtocol,i=function(){return b("VFWebCreateCallMutation.graphql")};function a(){return new(b("Promise"))(function(a,c){g(b("RelayFBEnvironment"),{mutation:i,variables:{input:{}},onCompleted:function(d){d=(d=d.messenger_create_call_conference)==null?void 0:d.conference_name;d?(b("RTCCallActions").initialize({protocol:h.MULTIWAY,conferenceName:d}),a()):c(new Error("Unrecognized response"))},onError:function(a){c(a)}})})}e.exports=a}),null);
__d("VFWebLogHistory",["LogHistory"],(function(a,b,c,d,e,f){"use strict";e.exports=b("LogHistory").getInstance("dvc")}),null);
__d("VFWebMediaUtils",["FBRTCConstants","RTCCallActions","RTCMediaDevices","RTCUserMediaConstraints","RTCUtils","VFWebAppFluxStore","promiseDone"],(function(a,b,c,d,e,f){"use strict";__p&&__p();var g=b("FBRTCConstants").VideoQuality,h={enableCamera:function(){b("promiseDone")(h.fetchAndAddLocalStreams())},disableCamera:function(){b("RTCCallActions").removeAllLocalStreams(!0)},fetchLocalStreams:function(a){a===void 0&&(a=!0);var c=b("VFWebAppFluxStore").getState();c=c.userSettings;var d=c.audioInput;c=c.videoInput;return b("RTCUtils").getUserMedia({audio:{deviceId:d},video:a?b("RTCUserMediaConstraints").video(g.FHD_IDEAL_LQ_REQUIRED_VIDEO,c):!1},{supportFilteredStreams:!1})},fetchAndAddLocalStreams:function(a){a===void 0&&(a=!0);return h.fetchLocalStreams(a).then(function(a){b("RTCCallActions").addLocalStream(a)})["catch"](function(a){})},getAvailableVideoInput:function(a,b){if(a.length===0)return null;a=a.map(h.getDeviceID).filter(Boolean);return a.includes(b)?b:a.length>0?a.pop():null},ensureValidCameraSelected:function(){var a=b("VFWebAppFluxStore").getState().userSettings.videoInput;b("promiseDone")(b("RTCMediaDevices").enumerateDevices().then(function(a){return a.filter(function(a){return a.kind==="videoinput"})}).then(function(b){return h.getAvailableVideoInput(b,a)}).then(function(c){c!=a&&b("VFWebAppFluxStore").updateVideoInputDevices(c)}))},getDeviceID:function(a){return a?a.deviceId:null}};e.exports=h}),null);
__d("VFWebStartCallMutation",["Promise","FBRTCConstants","FBRTCLocalMessageQueue","FBRTCParticipantCallState","RTCCallType","RTCCallActions","RTCCallInitUtils","RTCCallStore","RTCMWProtocolHandler","RTCP2PCallStore","VFWebConferenceNameUtils","generateRTCCallID","immutable","promiseDone"],(function(a,b,c,d,e,f){"use strict";__p&&__p();var g=b("FBRTCConstants").SignalingProtocol;function h(a,c,d,e){__p&&__p();return new(b("Promise"))(function(f,h){__p&&__p();b("RTCCallActions").initialize({protocol:g.P2P,conferenceName:d,serverInfoData:null,callID:a.callID,isCaller:!1,callType:e?b("RTCCallType").AUDIO_ONLY:b("RTCCallType").AUDIO_VIDEO});b("RTCCallInitUtils").initializeCallSummary({peerID:d,callID:a.callID!=null?a.callID:"0",isCaller:!1,isAudio:e,protocol:b("FBRTCConstants").SignalingProtocol.P2P});var i=b("RTCP2PCallStore").getState().protocolHandler;i.init(d,Number(a.callID)).setPreserveLocalStream(!0);b("RTCCallInitUtils").initializeRTCUsers([d,c.FBID],function(){var a=c.streams.first();a!==undefined&&b("RTCCallActions").addLocalStream(a);b("RTCCallActions").updateRemoteUsers(b("immutable").Set([b("RTCCallStore").getState().remoteUsers.first().setParticipantState({state:b("FBRTCParticipantCallState").CONNECTED})]));var e=b("FBRTCLocalMessageQueue").pluckOffer(d);b("promiseDone")(i.fetchTURNCredentials(),function(){i.startCall(undefined,e),i.processQueuedMessages(),f(b("RTCP2PCallStore").getState().protocolHandler)})})})}function i(a,c,d){c=c.streams.first();var e=new(b("RTCMWProtocolHandler"))(b("generateRTCCallID")());e.setKeepLocalStreamsOnClose(!0).setAllowIncomingCalls(!0);e.startCall(d,c!==undefined?[c]:[],a.conferenceName,{serverInfoData:a.serverInfoData,connectedOnJoin:!0});return e}function a(a,c,d,e){d===void 0&&(d=[]);return b("Promise").resolve().then(function(){var f=b("VFWebConferenceNameUtils").parseP2PConferenceName(a.conferenceName);return f!=null?h(a,c,f,e):i(a,c,d)})}e.exports=a}),null);
__d("VFWebCallUtils",["invariant","Promise","regeneratorRuntime","EnterMessengerCallRoomMutation","FBLogger","FBRTCConstants","FBRTCParticipantCallState","FBRTCSoundController","FluxTrigger","MercuryIDs","MessengerParticipants.bs","RelayFBEnvironment","RTCCallActions","RTCCallStore","RTCGroupCallEscalationActions","RTCGroupCallEscalationStore","RTCMWProtocolHandler","RTCP2PCallEscalator","RTCP2PProtocolHandler","RTCUser","VFDesktopHelper","VFWebAppFluxStore","VFWebCallStore","VFWebCreateCallMutation","VFWebEndCallMutation","VFWebLogHistory","VFWebMediaUtils","VFWebRingListener","VFWebStartCallMutation","immutable","promiseDone"],(function(a,b,c,d,e,f,g){"use strict";__p&&__p();var h=b("FBRTCConstants").CallEndReason,i=b("FBRTCConstants").SignalingProtocol,j={_isCallEnding:!1,placeOutgoingCall:function(a,c){__p&&__p();c===void 0&&(c=null);var d=b("RTCCallStore").getState();d=d.callInfo;if(!d.isInCall()){b("promiseDone")(j._placeOutgoingCall(a,c));return}b("promiseDone")(b("Promise").resolve().then(function(){return j._endAndCleanupCall({keepLocalStreams:!0,resetP2PListener:!0})}).then(function(){return j._placeOutgoingCall(a,c)})["catch"](function(b){return l("placeOutgoingCall",b,{receiverFbids:a,joinInfo:c})}))},joinConference:function(a,c){__p&&__p();b("promiseDone")(b("Promise").resolve().then(function(){return b("VFWebAppFluxStore").setJoiningConference(!0)}).then(function(){return j._ensureCameraEnabled()}).then(function(){return b("EnterMessengerCallRoomMutation")(c)}).then(function(a){a=a.conferenceName;if(a!=null)b("RTCCallActions").initialize({protocol:i.MULTIWAY,conferenceName:a,serverInfoData:null});else throw new Error("conferenceName could not be obtained")}).then(function(){return j._joinExistingCall({isAudio:!1,usersToRing:[a]})}).then(function(){return b("VFWebAppFluxStore").setLinkUrl(null)})["catch"](function(b){l("joinConference",b,{userID:a,linkUrl:c})})["finally"](function(){return b("VFWebAppFluxStore").setJoiningConference(!1)}))},inviteToCall:function(a){b("promiseDone")(j._inviteToCall(a))},cancelRing:function(a){var c=b("RTCCallStore").getState().callInfo,d=c.conferenceName;c=c.serverInfoData;b("promiseDone")(b("RTCMWProtocolHandler").removeParticipants(d,c,a))},answerIncomingCall:function(a){b("promiseDone")(j._answerIncomingCall(a))},ignoreIncomingCall:function(){b("promiseDone")(j._ignoreIncomingCall())},endAndCleanupCall:function(){b("promiseDone")(j._endAndCleanupCall({resetP2PListener:!0}))},reInviteToCall:function(a){b("promiseDone")(j._reInviteToCall(a))},isConnectedOrRinging:function(a){return j.isRinging(a)||j.isConnected(a)||((a=a.participantState)==null?void 0:a.state)===b("FBRTCParticipantCallState").UNKNOWN},isRinging:function(a){var c;return((c=a.participantState)==null?void 0:c.state)===b("FBRTCParticipantCallState").CONTACTING||((c=a.participantState)==null?void 0:c.state)===b("FBRTCParticipantCallState").RINGING},isConnected:function(a){var c;return((c=a.participantState)==null?void 0:c.state)===b("FBRTCParticipantCallState").CONNECTING||((c=a.participantState)==null?void 0:c.state)===b("FBRTCParticipantCallState").CONNECTED},isDisconnected:function(a){var c;return((c=a.participantState)==null?void 0:c.state)===b("FBRTCParticipantCallState").DISCONNECTED||((c=a.participantState)==null?void 0:c.state)===b("FBRTCParticipantCallState").NO_ANSWER||((c=a.participantState)==null?void 0:c.state)===b("FBRTCParticipantCallState").REJECTED||((c=a.participantState)==null?void 0:c.state)===b("FBRTCParticipantCallState").UNREACHABLE||((c=a.participantState)==null?void 0:c.state)===b("FBRTCParticipantCallState").CONNECTION_DROPPED||((c=a.participantState)==null?void 0:c.state)===b("FBRTCParticipantCallState").IN_ANOTHER_CALL},redialPreviousCall:function(){var a=b("VFWebAppFluxStore").getState();a=a.failedCallData;if(!a||!a.remoteUsers)throw new Error("Redial attempt with no previous call data!");j.placeOutgoingCall(a.remoteUsers.map(function(a){return a.FBID}).toArray(),a.conferenceName?{conferenceName:a.conferenceName}:null)},dismissPreviousCall:function(){b("VFWebAppFluxStore").setFailedCallData(null)},toggleLocalUserVideoInCall:function(){var a=b("RTCCallStore").getState(),c=a.localUser;a=a.callInfo;if(c.hasVideo()){b("RTCCallActions").toggleMuteVideo(c.isVideoMuted());return}c=c.getStream();c&&(a.protocol===i.MULTIWAY?b("RTCMWProtocolHandler").escalateLocalStream():a.protocol===i.P2P&&b("promiseDone")(b("RTCP2PCallEscalator").initEscalation()))},_ensureCameraEnabled:function(){var a=b("RTCCallStore").getState();a=a.localUser;return a.hasVideo()?b("Promise").resolve():b("VFWebMediaUtils").fetchAndAddLocalStreams()},_ensureAudioOnlyStream:function(){__p&&__p();var a=b("RTCCallStore").getState();a=a.localUser;var c=a.getStream();if(c)if(a.hasVideo())return b("VFWebMediaUtils").fetchLocalStreams(!1).then(function(a){b("RTCCallActions").replaceLocalStream(c,a)});else if(a.hasAudio())return b("Promise").resolve();return b("VFWebMediaUtils").fetchAndAddLocalStreams(!1)},_placeOutgoingCall:function(a,c){return b("Promise").resolve().then(function(){return j._ensureCameraEnabled()}).then(function(){return j._updateRemoteUsers(a)}).then(function(){return b("VFWebAppFluxStore").startCallingUsers(a)}).then(function(){return c&&c.conferenceName!=null?b("RTCCallActions").initialize({protocol:i.MULTIWAY,conferenceName:c.conferenceName,serverInfoData:c.serverInfoData}):b("VFWebCreateCallMutation")()}).then(function(){return j._joinExistingCall({usersToRing:a})})["catch"](function(d){l("_placeOutgoingCall",d,{receiverFbids:a,joinInfo:c});return b("VFWebAppFluxStore").leftCall()})},_joinExistingCall:function(a){var c=Boolean(a.isAudio),d=a.usersToRing||[];a=b("RTCCallStore").getState();var e=a.callInfo,f=a.localUser;return b("Promise").resolve().then(function(){return b("VFWebStartCallMutation")(e,f,d,c)}).then(function(a){b("VFWebAppFluxStore").joinedCall(a)})["catch"](function(a){return l("_joinExistingCall",a,{usersToRing:d})})},_inviteToCall:function(a){var c=b("RTCCallStore").getState().callInfo,d=c.conferenceName,e=c.serverInfoData;return b("Promise").resolve().then(function(){return j._addRemoteUsers(a)}).then(function(){return j._escalateIfNecessary(a)}).then(function(){return b("RTCMWProtocolHandler").addParticipants(d,e,a)})},_reInviteToCall:function(a){var c=b("RTCCallStore").getState().callInfo,d=c.conferenceName,e=c.serverInfoData;return b("Promise").resolve().then(function(){return b("RTCMWProtocolHandler").addParticipants(d,e,a)})},_escalateIfNecessary:function(a){__p&&__p();var c=b("VFWebAppFluxStore").getState().protocolHandler;if(c instanceof b("RTCP2PProtocolHandler")){b("RTCCallStore").getState().callInfo.protocol===i.P2P||g(0,3148);var d=a.map(function(a){return b("MercuryIDs").getParticipantIDFromUserID(a)});return new(b("Promise"))(function(a,e){b("MessengerParticipants.bs").getMulti(d,function(d){b("RTCGroupCallEscalationActions").setUsersToRing(b("immutable").Map(d)),c.escalateToMultiway(),b("promiseDone")(j._waitForEscalation(),a,e)})})}return b("Promise").resolve()},_waitForEscalation:function(){return new(b("Promise"))(function(a,c){b("FluxTrigger").create([b("RTCGroupCallEscalationStore")],function(){var a=b("RTCGroupCallEscalationStore").getState();return{isComplete:a.readyToTransition||a.aborted,isSuccess:a.readyToTransition}},function(b,d){!(b==null?void 0:b.isComplete)&&d.isComplete&&(d.isSuccess?a():c())})})},_answerIncomingCall:function(a){__p&&__p();return b("regeneratorRuntime").async(function(c){__p&&__p();while(1)switch(c.prev=c.next){case 0:if(!b("RTCCallStore").getState().callInfo.isInCall()){c.next=5;break}if(a.endCurrentCall){c.next=3;break}return c.abrupt("return",b("Promise").reject(new Error("in-call switching not supported yet.")));case 3:c.next=5;return b("regeneratorRuntime").awrap(j._endAndCleanupCall({keepLocalStreams:!0,resetP2PListener:a.signalingProtocol!==i.P2P}));case 5:b("RTCCallActions").initialize({protocol:a.signalingProtocol,conferenceName:a.conferenceName,serverInfoData:a.serverInfoData,callID:a.callID});return c.abrupt("return",(a.initializeVideo?j._ensureCameraEnabled():j._ensureAudioOnlyStream()).then(function(){return j._updateRemoteUsers(a.remoteUserFBIDs||[])}).then(function(){return j._joinExistingCall({isAudio:!a.initializeVideo})})["finally"](function(){return b("VFWebCallStore").resolveIncomingCall()}));case 7:case"end":return c.stop()}},null,this)},_ignoreIncomingCall:function(){return b("Promise").reject(new Error("Ignore in unsupported."))},_setFailedCallData:function(){__p&&__p();var a=b("RTCCallStore").getState(),c=a.callSummary;a=a.callInfo;var d=b("RTCCallStore").getState();d=d.remoteUsers;if(d.size===0)return;c=b("FBRTCConstants").endCallReasonFromString(c.getEndCallReason());d.size===1&&c===h.IGNORE_CALL&&(d=b("immutable").Set([d.first().setParticipantState({state:b("FBRTCParticipantCallState").REJECTED})]));var e=function(a){return a===b("FBRTCParticipantCallState").REJECTED||a===b("FBRTCParticipantCallState").NO_ANSWER||a===b("FBRTCParticipantCallState").UNREACHABLE||a===b("FBRTCParticipantCallState").IN_ANOTHER_CALL};d.every(function(a){return e((a=a.participantState)==null?void 0:a.state)})&&b("VFWebAppFluxStore").setFailedCallData({remoteUsers:d,conferenceName:d.size>1?a.conferenceName:null})},_endAndCleanupCall:function(a){__p&&__p();var c,d,e,f;return b("regeneratorRuntime").async(function(g){__p&&__p();while(1)switch(g.prev=g.next){case 0:c=b("VFWebAppFluxStore").getState(),d=c.miniViewActive;e=b("RTCCallStore").getState(),f=e.callInfo;if(!j._isCallEnding){g.next=4;break}return g.abrupt("return",b("Promise").resolve());case 4:j._isCallEnding=!0;f.isInCall()&&b("FBRTCSoundController").playLeaveCallSound();d&&b("VFDesktopHelper").restoreFromMiniView();return g.abrupt("return",b("Promise").resolve().then(function(){return j._setFailedCallData()}).then(function(){a.keepLocalStreams||b("RTCCallActions").removeAllLocalStreams(!0)}).then(b("VFWebAppFluxStore").leftCall).then(b("VFWebEndCallMutation"))["catch"](function(a){return l("_endAndCleanupCall",a)})["finally"](function(){a.resetP2PListener&&b("VFWebRingListener").listenP2P(),j._isCallEnding=!1}));case 8:case"end":return g.stop()}},null,this)},_addRemoteUsers:function(a){a=a.map(k).filter(Boolean).reduce(function(a,b){return a.add(b)},b("RTCCallStore").getState().remoteUsers);b("RTCCallActions").updateRemoteUsers(a)},_updateRemoteUsers:function(a){a=b("immutable").Set(a.map(k).filter(Boolean));b("RTCCallActions").updateRemoteUsers(a)}};function k(a){var c=b("RelayFBEnvironment").getStore().getSource();a=c.get(a);if(!a)return null;c=a.profile_picture&&c.get(a.profile_picture.__ref);c=c?c.uri:null;return new(b("RTCUser"))({FBID:a.id,isGuestUser:!1,isMessengerUser:!1,isPartiesUser:!1,lastConnectedAt:0,meetingID:null,meetingPassword:null,participantState:{state:b("FBRTCParticipantCallState").CONTACTING},profilePictureUrl:c,profileUrl:null,roomLocation:null,screenStreams:b("immutable").Set(),streams:b("immutable").Set(),userName:a.name,userShortName:a.short_name,vanity:""})}function l(a,c,d){d===void 0&&(d={}),b("VFWebLogHistory").error(a,JSON.stringify(babelHelpers["extends"]({error:{name:c.name,message:c.message,stack:c.stack}},d))),b("FBLogger")("VFWeb").mustfix(c)}e.exports=j}),null);
__d("MessengerVideoAppBridge",["fbt","CurrentLocale","CurrentUser","MessengerDialogs.bs","React","RTCCallStore","VFWebAppFluxStore","VFWebCallUtils","VFWebMediaUtils","VFWebSupportUtils","WorkchatAppKeyboardShortcutsDialog.react"],(function(a,b,c,d,e,f,g){"use strict";__p&&__p();a={toggleKeyboardShortCutsList:function(a){b("MessengerDialogs.bs").showDialog(function(){return b("React").createElement(b("WorkchatAppKeyboardShortcutsDialog.react"),{platform:a})})},toggleListTray:function(){b("VFWebAppFluxStore").toggleListTray()},closeListTray:function(){b("VFWebAppFluxStore").closeListTray()},openListTray:function(){b("VFWebAppFluxStore").openListTray()},isMiniViewSupported:function(){return b("VFWebSupportUtils").isMiniViewSupported()},setMiniViewStatus:function(a){b("VFWebAppFluxStore").setMiniViewStatus(a)},getCurrentUser:function(){return{isWorkUser:b("CurrentUser").isWorkUser,isEmployee:b("CurrentUser").isEmployee,getID:b("CurrentUser").getID}},getCurrentLocale:function(){return b("CurrentLocale").get()},getInCall:function(){return b("RTCCallStore").getState().callInfo.isInCall()},closeAddPeopleTray:function(){b("VFWebAppFluxStore").closeAddPeopleTray()},localUserHasVideoEnabled:function(){var a=b("RTCCallStore").getState();a=a.localUser;return a.hasVideo()&&!a.isVideoMuted()},showAppUpdateBanner:function(a){b("VFWebAppFluxStore").setPromotionData({content:g._("A new update is available!"),glyph:"download",actionTitle:g._("Update now"),actionCallback:a,dismissCallback:function(){b("VFWebAppFluxStore").setPromotionData(null)}})},endCall:function(){b("VFWebCallUtils").endAndCleanupCall()},disableCamera:function(){b("VFWebMediaUtils").disableCamera()}};e.exports=a}),null);
__d("AbstractTextInput.react",["cx","AbstractTextField.react","React"],(function(a,b,c,d,e,f,g){__p&&__p();var h;c=b("React").Component;h=babelHelpers.inherits(a,c);h&&h.prototype;a.prototype.render=function(){"use strict";return b("React").createElement(b("AbstractTextField.react"),this.props,b("React").createElement("input",{className:"_58al",onClick:this.props.onClick,onMouseDown:this.props.onMouseDown,onKeyUp:this.props.onKeyUp,onKeyDown:this.props.onKeyDown,onPaste:this.props.onPaste,size:this.props.size,tabIndex:this.props.tabIndex,type:this.props.type,ref:function(a){return this.$1=a}.bind(this)}))};a.prototype.focusInput=function(){"use strict";this.$1&&this.$1.focus()};a.prototype.blurInput=function(){"use strict";this.$1&&this.$1.blur()};a.prototype.selectInput=function(){"use strict";this.$1&&this.$1.select()};a.prototype.getTextFieldDOM=function(){"use strict";return this.$1};a.prototype.getValue=function(){"use strict";return this.$1?this.$1.value:""};function a(){"use strict";h.apply(this,arguments)}a.propTypes=b("AbstractTextField.react").propTypes;a.defaultProps={type:"text"};e.exports=a}),null);